var QuillImageDropAndPaste=function(t){"use strict";var e={isRichText(t){let e=!1;return Array.prototype.forEach.call(t,(t=>{t.type.match(/^text\/html$/i)&&(e=!0)})),e},resolveDataUrl(t){let e="";return"string"==typeof t?e=t:t instanceof ArrayBuffer&&(e=this.arrayBufferToBase64Url(t)),e},arrayBufferToBase64Url:t=>btoa(String.fromCharCode(...new Uint8Array(t))),isType:(t,e)=>Object.prototype.toString.call(t)===`[object ${e}]`};class i extends class{constructor(t,e,i){this.dataUrl=t,this.type=e,this.name=i||""}}{}class a extends class{constructor(t,e){this.quill=t,this.option=e}}{constructor(t,e){super(t,e),this.quill=t,this.option=e,this.handlePaste=this.handlePaste.bind(this),this.insert=this.insert.bind(this),this.quill.root.addEventListener("paste",this.handlePaste,!1)}handlePaste(t){if(t.clipboardData&&t.clipboardData.items&&t.clipboardData.items.length){if(e.isRichText(t.clipboardData.items))return;this.readFiles(t.clipboardData.items,((t,a="image/png")=>{"function"==typeof this.option.handler?this.option.handler.call(this,t,a,new i(t,a)):this.insert(e.resolveDataUrl(t),"image")}),t)}}readFiles(t,i,a){Array.prototype.forEach.call(t,(t=>{e.isType(t,"DataTransferItem")&&this.handleDataTransfer(t,i,a)}))}handleDataTransfer(t,e,i){const{type:a}=t;if(a.match(/^image\/(gif|jpe?g|a?png|svg|webp|bmp)/i)){i.preventDefault();const s=new FileReader;s.onload=t=>{t.target&&t.target.result&&e(t.target.result,a)};const r=t.getAsFile?t.getAsFile():t;r instanceof Blob&&s.readAsDataURL(r)}}insert(t,e){const i=this.getIndex();let a;"image"===e?(a=i+1,this.quill.insertEmbed(i,e,t,"user")):"text"===e&&(a=i+t.length,this.quill.insertText(i,t,"user")),setTimeout((()=>{this.quill.setSelection(a)}))}getIndex(){let t=(this.quill.getSelection(!0)||{}).index;return(void 0===t||t<0)&&(t=this.quill.getLength()),t}}return a.ImageData=i,window.QuillImageDropAndPaste=a,"Quill"in window&&window.Quill.register("modules/imageDropAndPaste",a),t.ImageData=i,t.default=a,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
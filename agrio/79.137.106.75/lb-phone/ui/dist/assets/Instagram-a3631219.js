import{j as e,F as B,r as a,a as s}from"./jsx-runtime-7cf68bf7.js";import{u as ee,b as te,H as z,T as q,f as p,au as ke,C as H,L as i,Z as ae,r as Ee,aw as Te,bt as ge,Y as K,az as Le,bu as ne,S as se,b3 as Me,aa as oe,o as Y,N as ve,a8 as de,bq as Ne,U as re,a6 as Se,h as Q,q as Pe,Q as Ae,B as Re,K as le,$ as ue,a0 as fe,ar as Oe,aH as ye,bv as Ge,m as Ve}from"./Phone-ec5c0d3e.js";import{C as _e}from"./Check-676db25c.js";import{a as be}from"./DotSpinner-3c5cddfa.js";function pe(n){const v=ee(te.Settings);return e(B,{children:n.liked?e("svg",{onClick:n.onClick,color:"#ed4956",fill:"#ed4956",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})}):e("svg",{onClick:n.onClick,color:v.display.theme==="dark"?"#ffffff":"#262626",fill:v.display.theme==="dark"?"#ffffff":"#262626",height:"24",viewBox:"0 0 24 24",width:"24",children:e("path",{d:"M16.792 3.904A4.989 4.989 0 0121.5 9.122c0 3.072-2.652 4.959-5.197 7.222-2.512 2.243-3.865 3.469-4.303 3.752-.477-.309-2.143-1.823-4.303-3.752C5.141 14.072 2.5 12.167 2.5 9.122a4.989 4.989 0 014.708-5.218 4.21 4.21 0 013.675 1.941c.84 1.175.98 1.763 1.12 1.763s.278-.588 1.11-1.766a4.17 4.17 0 013.679-1.938m0-2a6.04 6.04 0 00-4.797 2.127 6.052 6.052 0 00-4.787-2.127A6.985 6.985 0 00.5 9.122c0 3.61 2.55 5.827 5.015 7.97.283.246.569.494.853.747l1.027.918a44.998 44.998 0 003.518 3.018 2 2 0 002.174 0 45.263 45.263 0 003.626-3.115l.922-.824c.293-.26.59-.519.885-.774 2.334-2.025 4.98-4.32 4.98-7.94a6.985 6.985 0 00-6.708-7.218z"})})})}function Ie(n){const{Account:v,View:T,Func:l,UserPanel:c}=a.useContext($),d=ee(te.Settings),[f]=v,[M,E]=T,[m,P]=c,[t,L]=a.useState(n.data),C=a.useRef(null);a.useRef(null);const[u,I]=a.useState(0),[h,G]=a.useState(!1),S={pos:{startLeft:0,startX:0},onMouseDown:g=>{S.pos={startLeft:C.current.scrollLeft,startX:g.clientX},C.current.style.userSelect="none",document.addEventListener("mouseup",S.onMouseUp),document.addEventListener("mousemove",S.onMove)},onMove:g=>{const _=(g.clientX-S.pos.startX)/Te(d.display.size);C.current.scrollLeft=S.pos.startLeft-_;const N=C.current.getBoundingClientRect();(N.left-5>g.clientX||g.clientX>N.right-5)&&S.onMouseUp()},onMouseUp:g=>{C.current.style.removeProperty("user-select"),document.removeEventListener("mouseup",S.onMouseUp),document.removeEventListener("mousemove",S.onMove);const _=JSON.parse(t.media),N=C.current.clientWidth;let k=u;const w=C.current.scrollLeft-S.pos.startLeft;w>N/2&&k<_.length-1?k++:w<-N/2&&k>0&&k--,V(k)}},V=g=>{C.current.scrollTo({left:g*C.current.offsetWidth,behavior:"smooth"}),I(g)};z("instagram:setLikes",g=>{g.postId!==t.id||g.isComment||L({...t,like_count:g.likes})});const F=g=>{if(g.detail===2){if(!t.id)return;t.liked||p("Instagram",{action:"toggleLike",data:{postId:t.id,toggle:!t.liked,isComment:!1}}).then(_=>{L({...t,liked:_.liked,like_count:_.likes})}),G(!0),setTimeout(()=>{G(!1)},1e3)}};return s("div",{className:"post",id:n.last?"last":"",children:[s("div",{className:"post-header",children:[e("img",{className:"profile-picture",onClick:()=>{l.fetchAndSetProfile(t.username)},src:l.getAvatar(t.avatar)}),s("div",{className:"name",onClick:()=>l.fetchAndSetProfile(t.username),children:[t.username,t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]})]}),s("div",{className:"post-body",children:[h&&e("div",{className:`popup-heart ${h?"show":"hide"}`,children:e("svg",{color:"#e3e3e3",fill:"#e3e3e3",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})})}),e("div",{className:"image-container",ref:C,onMouseDown:S.onMouseDown,children:JSON.parse(t.media).map((g,_)=>e("div",{className:"image",onClick:F,children:q(g)?e("video",{src:g,autoPlay:!0,loop:!0,muted:!0}):e("img",{src:g})},_))}),s("div",{className:"actions",children:[s("div",{className:"like-comment",children:[e(pe,{liked:t.liked,onClick:()=>{t.id&&p("Instagram",{action:"toggleLike",data:{postId:t.id,toggle:!t.liked,isComment:!1}}).then(g=>{L({...t,liked:g.liked,like_count:g.likes})})}}),e("svg",{onClick:()=>l.fetchAndSetComments(t),color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",children:e("path",{d:"M20.656 17.008a9.993 9.993 0 10-3.59 3.615L22 22z",fill:"none",stroke:"currentColor",strokeWidth:"2px"})}),(t.username===f.username||f.isAdmin)&&e(ke,{onClick:()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.DELETE_POST_POPUP.TITLE"),description:i("APPS.INSTAGRAM.DELETE_POST_POPUP.DESCRIPTION"),buttons:[{title:i("APPS.INSTAGRAM.DELETE_POST_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.DELETE_POST_POPUP.PROCEED"),color:"red",cb:()=>{p("Instagram",{action:"deletePost",id:t.id}).then(g=>{g&&E("feed")})}}]})}})]}),JSON.parse(t.media).length>1&&e("div",{className:"scroll-dots",children:JSON.parse(t.media).map((g,_)=>e("div",{className:`dot ${u==_?"active":""}`,onClick:()=>V(_)},_))})]}),s("div",{className:"liked-by",onClick:()=>{P({display:!0,data:{title:i("APPS.INSTAGRAM.LIKED_BY"),postId:t.id,cb:()=>{E("feed")}}})},children:[t.like_count," ",i("APPS.INSTAGRAM.LIKES")]}),s("div",{className:"caption",children:[e("span",{className:"user",onClick:g=>{g.stopPropagation(),l.fetchAndSetProfile(t.username)},children:t.username}),ae(t.caption)," "]}),e("div",{className:"comments",onClick:g=>{g.stopPropagation(),l.fetchAndSetComments(t)},children:t.comment_count>0?i("APPS.INSTAGRAM.VIEW_ALL_COMMENTS").format({count:t.comment_count}):i("APPS.INSTAGRAM.FIRST_COMMENT")}),e("div",{className:"date",children:Ee(t.timestamp)})]})]})}function Fe(n){const{Account:v,View:T,Post:l,Func:c,Stories:d}=a.useContext($),[f,M]=T,[E]=v,[m,P]=a.useState([]),[t,L]=a.useState([]),[C,u]=d,[I,h]=a.useState(0),[G,S]=a.useState(!1),[V,F]=a.useState(!1);a.useEffect(()=>{p("Instagram",{action:"getPosts",filters:{following:!0},page:0}).then(N=>{N&&P(N)})},[]),a.useEffect(()=>{f==="feed"&&(p("Instagram",{action:"getLives"}).then(N=>{N&&L(N)}),p("Instagram",{action:"getStories"}).then(N=>{N&&u([...N.sort((k,w)=>{if(k.seen===w.seen)return 0;if(k.seen===1)return 1;if(w.seen===1)return-1})])}))},[f]);const g=N=>{if(G||V)return;let k=document.querySelector("#last");if(!k)return;!K(k)&&(F(!0),p("Instagram",{action:"getPosts",filters:{following:!0},page:I+1}).then(r=>{r&&r.length>0?(P([...m,...r]),F(!1)):S(!0)}),h(r=>r+1))};a.useEffect(()=>{const N=document.querySelector(".stories");N.addEventListener("wheel",k=>{k.preventDefault(),N.scrollLeft+=k.deltaY})},[]),z("instagram:updateLives",N=>{N&&L(N)});const _=()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.GO_LIVE_POPUP.TITLE"),description:i("APPS.INSTAGRAM.GO_LIVE_POPUP.DESCRIPTION"),buttons:[{title:i("APPS.INSTAGRAM.GO_LIVE_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.GO_LIVE_POPUP.PROCEED"),color:"red",cb:()=>{p("Instagram",{action:"goLive",user:{username:E.username,avatar:c.getAvatar(E==null?void 0:E.avatar),verified:E.verified}}),M("live")}}]})};return s(B,{children:[s("div",{className:"instagram-header feed-header",children:[s("div",{className:"name",children:[E.username,E.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),s("svg",{onClick:()=>M("dmList"),color:"#262626",fill:"#262626",height:"24",role:"img",viewBox:"0 0 24 24",width:"24",children:[e("line",{fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2",x1:"22",x2:"9.218",y1:"3",y2:"10.083"}),e("polygon",{fill:"none",points:"11.698 20.334 22 3.001 2 3.001 9.218 10.084 11.698 20.334",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2"})]})]}),s("div",{className:"feed",onScroll:g,children:[e("div",{className:"stories-wrapper",children:s("div",{className:"stories",children:[s("div",{className:"story self",onClick:()=>{H.ContextMenu.set({buttons:[{title:i("APPS.INSTAGRAM.GO_LIVE"),cb:()=>{_()}},{title:i("APPS.INSTAGRAM.CREATE_STORY"),cb:()=>{H.Gallery.set({includeVideos:!0,onSelect:N=>{p("Instagram",{action:"addToStory",media:N.src}).then(k=>{k&&u(w=>[{username:E.username,avatar:E.avatar,verified:E.verified,seen:!1,id:k},...w.filter(r=>r.username!==E.username)])})}})}}]})},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${c.getAvatar(E==null?void 0:E.avatar)})`},children:e("div",{className:"plus",children:e("i",{className:"far fa-plus"})})}),e("div",{className:"name",children:i("APPS.INSTAGRAM.YOUR_STORY")})]}),Object.keys(t).map((N,k)=>{var w;return s("div",{className:"story",onClick:()=>{p("Instagram",{action:"viewLive",username:N}),M("live")},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${c.getAvatar((w=t[N])==null?void 0:w.avatar)})`},children:e("img",{className:"circle live",src:"./assets/img/icons/instagram/LiveCircle.png"})}),e("div",{className:"name",children:N})]},k)}),C.map((N,k)=>s("div",{className:"story",onClick:w=>{let[r,R]=ge(w);c.fetchAndSetStory(N,null,{x:r,y:R})},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${c.getAvatar(N==null?void 0:N.avatar)})`},children:e("img",{className:"circle","data-seen":N.seen===1,src:"./assets/img/icons/instagram/StoryCircle.png"})}),e("div",{className:"name",children:N.username})]},k))]})}),m.length===0&&e("div",{className:"no-posts",children:i("APPS.INSTAGRAM.EMPTY_FEED")}),m.map((N,k)=>{let w=k===m.length-1;return e(Ie,{data:N,last:w},k)})]})]})}function De(){const{View:n,Account:v,Func:T}=a.useContext($),[l,c]=n,[d]=v,f=ee(ve),[M,E]=a.useState(""),[m,P]=a.useState(!1),[t,L]=a.useState(!1),C=a.useRef(null),[u,I]=a.useState({user:{username:"",avatar:"",verified:!1},viewers:0}),h=a.useRef(null),G=a.useRef(null),S=a.useRef(null),[V,F]=a.useState([]),[g,_]=a.useState([]),[N,k]=a.useState(null);a.useEffect(()=>{G.current.scrollTop=G.current.scrollHeight},[g]),a.useEffect(()=>{if(!N||S.current)return;let A=new Le(N);S.current=A,A.resizeByAspect(3/4);const o=window.innerWidth;o>1280&&A.setQuality(1280/o)},[N]),a.useEffect(()=>()=>{S.current&&S.current.destroy()},[]),a.useEffect(()=>{const A=u;if(!(A!=null&&A.id)||!h.current||m)return;const o=f.ice?new ne({iceTransportPolicy:"relay",config:{iceServers:f.ice}}):new ne;o.on("open",()=>{const y=document.createElement("canvas");y.width=5,y.height=5;const O=y.captureStream(0),D=o.call(A.id,O);F([...V,D]),D.on("close",()=>{y.remove()}),D.on("error",()=>{y.remove()}),D.on("stream",U=>{const b=h.current;b.onloadeddata=()=>{b.play()},b.srcObject=U,p("Instagram",{action:"addCall",id:D.connectionId,username:d.username})})})},[h.current,u.user]),a.useEffect(()=>{if(P(d.username===(u==null?void 0:u.user.username)),(u==null?void 0:u.user.username)!==d.username||!N)return;const A=f.ice?new ne({iceTransportPolicy:"relay",config:{iceServers:f.ice}}):new ne;A.on("open",y=>{p("Instagram",{action:"setLive",username:d.username,verified:d.verified,id:y})});const o=N.captureStream(24);A.on("call",y=>{y.answer(o),y.on("close",()=>{F(V.filter(O=>O.connectionId!==y.connectionId))}),F([...V,y])})},[u,N]);const w=()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.END_LIVE_POPUP.TITLE"),description:i("APPS.INSTAGRAM.END_LIVE_POPUP.DESCRIPTION").format({action:(m?i("APPS.INSTAGRAM.END_LIVE_POPUP.END"):i("APPS.INSTAGRAM.END_LIVE_POPUP.LEAVE")).toLowerCase()}),buttons:[{title:i("APPS.INSTAGRAM.END_LIVE_POPUP.CANCEL")},{title:m?i("APPS.INSTAGRAM.END_LIVE_POPUP.END"):i("APPS.INSTAGRAM.END_LIVE_POPUP.LEAVE"),color:"red",cb:()=>{se.ShouldClose.set(!0),R(!0)}}]})},r=()=>{p("Instagram",{action:"sendLiveMessage",data:{user:{username:d.username,avatar:d.avatar,verified:d.verified},live:u.user.username,content:M}}),E("")},R=(A,o)=>{if(m)p("Instagram",{action:"endLive",username:d.username}).then(()=>{c("feed")});else if(p("Instagram",{action:"stopViewing",username:u.user.username}),A)se.ShouldClose.set(!0),I({...u,ended:!0});else{if(o===!1)return;c("feed")}V.forEach(y=>{y.close()}),F([])};return z("instagram:addMessage",A=>{A.live===u.user.username&&_([...g,A])}),z("instagram:updateViewers",A=>{A.username===(u==null?void 0:u.user.username)&&I({...u,viewers:A.viewers})}),z("instagram:setLive",A=>{I(A),se.ShouldClose.set(!1)}),z("instagram:liveEnded",A=>{A===(u==null?void 0:u.user.username)&&R(!0)}),z("instagram:stopLive",()=>{c("feed")}),z("instagram:endCall",A=>{V.forEach(o=>{o.connectionId===A&&o.close()}),F(V.filter(o=>o.connectionId!==A))}),s(B,{children:[e("div",{className:"instagram-stream",children:m?e("canvas",{ref:A=>k(A)}):e("video",{ref:h})}),u.ended&&s("div",{className:"instagram-stream-ended",children:[e(Me,{onClick:()=>c("feed")}),e("div",{className:"title",children:i("APPS.INSTAGRAM.LIVE_ENDED")})]}),e(oe,{children:t&&e(Ue,{username:u.user.username,owner:m,endLive:R,close:()=>L(!1)})}),s("div",{className:"instagram-live",children:[s("div",{className:"live-header",children:[s("div",{className:"profile",onClick:()=>{m||(R(),T.fetchAndSetProfile(u.user.username))},children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${u.user.avatar?u.user.avatar:"./assets/img/icons/instagram/unknown-pfp.jpg"})`}}),s("div",{className:"name",children:[u.user.username.length>12?u.user.username.substring(0,12)+"...":u.user.username,u.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]})]}),s("div",{className:"stats",children:[e("div",{className:"live",children:i("APPS.INSTAGRAM.LIVE")}),s("div",{className:"viewers",onClick:()=>L(!0),children:[e("i",{className:"fas fa-eye"}),u.viewers]}),e("i",{className:"far fa-times x",onClick:()=>{m?w():R(!1)}})]})]}),s("div",{className:"comment-section",children:[e("div",{className:"comment-feed",ref:G,children:g.map((A,o)=>{let y=A.user.avatar??"./assets/img/icons/instagram/unknown-pfp.jpg";return s("div",{className:"comment",children:[e("img",{src:y}),s("div",{className:"info",children:[s("div",{className:"name",children:[A.user.username,A.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"comment-text",children:A.content})]})]},o)})}),s("div",{className:"comment-input",children:[e(Y,{type:"text",ref:C,placeholder:i("APPS.INSTAGRAM.COMMENT_PLACEHOLDER"),onChange:A=>E(A.target.value),onKeyDown:A=>{A.key==="Enter"&&M.replace(/ /g,"").length>0&&(r(),C.current.value="")}}),e("i",{className:"far fa-paper-plane",onClick:()=>{M.replace(/ /g,"").length>0&&(r(),C.current.value="")}}),m&&e("i",{className:"fas fa-repeat",onClick:()=>{p("Instagram",{action:"flipCamera"})}})]})]})]})]})}const Ue=n=>{const{Func:v}=a.useContext($),[T,l]=a.useState([]);return a.useEffect(()=>{p("Instagram",{action:"getLiveViewers",username:n.username}).then(c=>{c&&(console.log(c),l(c))})},[]),s(de.div,{className:"story-modal",initial:{y:600},animate:{y:0},exit:{y:600},transition:{duration:.35,ease:"easeInOut"},children:[s("div",{className:"story-modal-header",children:[s("div",{className:"views",children:[e(Ne,{})," ",e("div",{className:"views",children:T.length})]}),e(re,{className:"close",onClick:n==null?void 0:n.close})]}),s("div",{className:"story-modal-content",children:[e("div",{className:"title",children:i("APPS.INSTAGRAM.STORY_VIEWERS")}),e("div",{className:"viewers",children:T.map((c,d)=>{let f=d===T.length-1?"last":"";return e("div",{className:"item",id:f,children:s("div",{className:"user",onClick:()=>{n.owner||(n.endLive(!1,!1),v.fetchAndSetProfile(c.username))},children:[e("div",{className:"profile-picture",children:e("img",{src:v.getAvatar(c.avatar)})}),s("div",{className:"user-details",children:[s("div",{className:"username",children:[c.username,c.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:c.name})]})]})},d)})})]})]})};function xe(){const{View:n,Profile:v,Account:T,Func:l,GoBack:c,Post:d,UserPanel:f,LoggedIn:M,Dm:E}=a.useContext($),[m,P]=n,[t,L]=v,[C,u]=M,[I,h]=T,[G,S]=d,[V,F]=E,[g,_]=f,[N,k]=c,[w,r]=a.useState(!1),[R,A]=a.useState(!1),[o,y]=a.useState(null),[O,D]=a.useState(0),[U,b]=a.useState(!1),[x,j]=a.useState(!1);a.useEffect(()=>{t.username&&(r(I.username===t.username),p("Instagram",{action:"getPosts",filters:{profile:!0,username:t.username},page:0}).then(W=>{W&&y(W)}))},[t]);const J=()=>{if(U||x)return;let W=document.querySelector("#last");if(!W)return;!K(W)&&(j(!0),p("Instagram",{action:"getPosts",filters:{profile:!0,username:t.username},page:O+1}).then(X=>{X&&X.length>0?(y([...o,...X]),j(!1)):b(!0)}),D(X=>X+1))},we=W=>{t.name&&p("Instagram",{action:"updateProfile",data:{name:t.name,bio:t.bio,avatar:t.avatar}}).then(Z=>{Z&&A(!1)})};z("instagram:setFollowers",W=>{W.username===t.username&&L({...t,followers:W.followers})}),z("instagram:setFollowing",W=>{W.username===t.username&&L({...t,following:W.following})});const me=a.useRef(!0);return a.useEffect(()=>{if(me.current){me.current=!1;return}p("Instagram",{action:"toggleFollow",data:{username:t.username,following:t.isFollowing}})},[t.isFollowing]),e(B,{children:t&&e("div",{className:"profile",children:R?s("div",{className:"slide up",children:[s("div",{className:"edit-profile-header",children:[e("div",{className:"cancel",onClick:()=>A(!1),children:i("CANCEL")}),e("div",{className:"title",children:i("APPS.INSTAGRAM.EDIT_PROFILE")}),e("div",{className:"save",onClick:()=>we(),children:i("APPS.INSTAGRAM.DONE")})]}),s("div",{className:"edit-profile-body",children:[s("div",{className:"profile-picture",onClick:()=>{H.Gallery.set({onSelect:W=>{L({...t,avatar:W.src}),h({...I,avatar:W.src})}})},children:[e("img",{src:l.getAvatar(t.avatar),alt:"profile"}),e("span",{children:i("APPS.INSTAGRAM.CHANGE_PICTURE")})]}),s("div",{className:"profile-items",children:[s("div",{className:"item",children:[e("div",{className:"title",children:i("APPS.INSTAGRAM.NAME")}),e(Y,{placeholder:i("APPS.INSTAGRAM.NAME_PLACEHOLDER"),onChange:W=>{L({...t,name:W.target.value})},maxLength:30,defaultValue:t.name})]}),s("div",{className:"item",children:[e("div",{className:"title",children:i("APPS.INSTAGRAM.BIO")}),e(Se,{placeholder:i("APPS.INSTAGRAM.BIO"),onChange:W=>{L({...t,bio:W.target.value})},maxLength:100,defaultValue:t.bio??""})]})]}),e("div",{className:"sign-out",onClick:()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.SIGN_OUT_POPUP.TITLE"),description:i("APPS.INSTAGRAM.SIGN_OUT_POPUP.DESCRIPTION"),buttons:[{title:i("APPS.INSTAGRAM.SIGN_OUT_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.SIGN_OUT_POPUP.PROCEED"),color:"red",cb:()=>{p("Instagram",{action:"signOut"}).then(W=>{u(null),h(null),Q.APPS.INSTAGRAM.account.set(!1)})}}]})},children:"Sign Out"})]})]}):s(B,{children:[w?s("div",{className:"instagram-header",children:[e("div",{className:"name",children:t.username??"Unknown"}),t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}):s("div",{className:"profile-header",children:[e("i",{className:"fas fa-chevron-left",onClick:()=>{N!=null&&N.cb?N.cb():P("feed")}}),s("div",{className:"name",children:[t.username??"Unknown",t.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("span",{})]}),s("div",{className:"profile-body",children:[s("div",{className:"profile-wrapper",children:[s("div",{className:"top",children:[s("div",{className:"profile-picture",style:{backgroundImage:`url(${l.getAvatar(t.avatar)})`},children:[t.isLive&&e("img",{onClick:()=>{p("Instagram",{action:"viewLive",username:t.username}),P("live")},className:"circle live",src:"./assets/img/icons/instagram/LiveCircle.png"}),t.hasStory&&!t.isLive?e("img",{className:"circle","data-seen":t.seenStory===1,src:"./assets/img/icons/instagram/StoryCircle.png",onClick:W=>{let[Z,X]=ge(W);l.fetchAndSetStory({username:t.username,avatar:t.avatar,verified:t.verified},null,{x:Z,y:X})}}):null]}),s("div",{className:"stats",children:[s("div",{children:[e("div",{className:"value",children:t.posts}),e("div",{className:"label",children:t.posts===1?i("APPS.INSTAGRAM.POST"):i("APPS.INSTAGRAM.POSTS")})]}),s("div",{onClick:()=>{_({display:!0,data:{title:"Followers",username:t.username,cb:()=>{L(t),P("profile"),_({display:!1})}}})},children:[e("div",{className:"value",children:t.followers}),e("div",{className:"label",children:t.followers===1?i("APPS.INSTAGRAM.FOLLOWER"):i("APPS.INSTAGRAM.FOLLOWERS")})]}),s("div",{onClick:()=>{_({display:!0,data:{title:i("APPS.INSTAGRAM.FOLLOWING"),username:t.username,cb:()=>{L(t),P("profile"),_({display:!1})}}})},children:[e("div",{className:"value",children:t.following}),e("div",{className:"label",children:i("APPS.INSTAGRAM.FOLLOWING")})]})]})]}),e("div",{className:"name",children:t.name}),e("div",{className:"description",children:ae(t.bio)??""}),e("div",{className:"buttons",children:w?w&&e("div",{className:"button edit",onClick:()=>{A(!0)},children:i("APPS.INSTAGRAM.EDIT_PROFILE")}):s(B,{children:[t.isFollowing?e("div",{className:"button following",onClick:()=>{H.PopUp.set({title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:t.username}),buttons:[{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{L({...t,isFollowing:!1})}}]})},children:i("APPS.INSTAGRAM.FOLLOWING")}):e("div",{className:"button follow",onClick:()=>{L({...t,isFollowing:!0})},children:i("APPS.INSTAGRAM.FOLLOW")}),e("div",{className:"button following",onClick:()=>{F({username:t.username,name:t.name,verified:t.verified,avatar:t.avatar}),P("dm")},children:i("APPS.INSTAGRAM.MESSAGE")})]})})]}),e("div",{className:"posts",onScroll:J,children:o&&o.map((W,Z)=>{let X=Z===o.length-1?"last":"",ce=JSON.parse(W.media)[0];return e("div",{id:X,onClick:()=>{k({cb:()=>{L(t),P("profile"),S(null),k(null)}}),S(W),P("post")},children:q(ce)?e("video",{src:ce,muted:!0,autoPlay:!0,loop:!0}):e("img",{src:ce})},Z)})})]})]})})})}function he(){const{View:n,Account:v,LoggedIn:T}=a.useContext($),l=ee(te.Settings),[c,d]=a.useState(""),[f,M]=a.useState(""),[E,m]=a.useState(""),[P,t]=a.useState(!1),[L,C]=a.useState(!1),[u,I]=a.useState(!1),[h,G]=n,[S,V]=v,[F,g]=T,[_,N]=a.useState("login"),k=()=>{t(!1),C(!1),p("Instagram",{action:"logIn",username:f,password:E}).then(r=>{r.success&&r.account?(C(!1),t(!1),p("isAdmin").then(R=>{Q.APPS.INSTAGRAM.account.set(r.account),V({...r.account,isAdmin:R}),G("feed"),g(!0)})):r.error=="no account"?t(!0):r.error=="wrong password"?C(!0):console.log("Unknown error, please contact support with: Instagram LogIn.jsx onLogIn:43 [ALREADY LOGGED IN]",r==null?void 0:r.error)})},w=()=>{let r=f.toLowerCase().replace(/\s/g,"");r.length<3||r.length>15||p("Instagram",{action:"createAccount",name:c,username:r,password:E}).then(R=>{R.success?(C(!1),t(!1),p("isAdmin").then(A=>{let o={name:c,username:r,posts:0,followers:0,following:0};Q.APPS.INSTAGRAM.account.set(o),V({...o,isAdmin:A}),G("feed"),g(!0)})):console.log("couldn't create account",R)})};return a.useEffect(()=>{C(!1),t(!1)},[_]),e("div",{className:"log-in",children:s(B,{children:[e("div",{className:"wrapper",children:_==="login"?s(B,{children:[e("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Instagram_logo.svg/2560px-Instagram_logo.svg.png","data-theme":l.display.theme}),s("div",{className:"form",children:[e(Y,{placeholder:i("APPS.INSTAGRAM.USERNAME_PLACEHOLDER"),type:"text",className:"username",onChange:r=>M(r.target.value.replace(/\s/g,"")),maxLength:15}),P&&e("div",{className:"instagram-wrong",children:i("APPS.INSTAGRAM.NO_ACCOUNT")}),e(Y,{placeholder:i("APPS.INSTAGRAM.PASSWORD_PLACEHOLDER"),type:"password",onChange:r=>m(r.target.value),maxLength:50}),L&&e("div",{className:"instagram-wrong",children:i("APPS.INSTAGRAM.WRONG_USERNAME_OR_PASSWORD")}),e("div",{className:"button",onClick:k,children:i("APPS.INSTAGRAM.LOG_IN")})]})]}):s(B,{children:[e("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Instagram_logo.svg/2560px-Instagram_logo.svg.png","data-theme":l.display.theme}),s("div",{className:"form",children:[e(Y,{placeholder:i("APPS.INSTAGRAM.NAME_PLACEHOLDER"),type:"text",onChange:r=>d(r.target.value),maxLength:20}),e(Y,{placeholder:i("APPS.INSTAGRAM.USERNAME_PLACEHOLDER"),type:"text",className:"username",onChange:r=>M(r.target.value.replace(/\s/g,"")),maxLength:15}),u&&e("div",{className:"instagram-wrong",children:i("APPS.INSTAGRAM.ACCOUNT_WITH_USERNAME")}),e(Y,{placeholder:i("APPS.INSTAGRAM.PASSWORD_PLACEHOLDER"),type:"password",onChange:r=>m(r.target.value),maxLength:50}),e("div",{className:"button",onClick:w,children:i("APPS.INSTAGRAM.CREATE_ACCOUNT")})]})]})}),e("div",{className:"footer",children:_==="login"?s(B,{children:[i("APPS.INSTAGRAM.NOT_HAVE_ACCOUNT")," ",e("span",{onClick:()=>N("createAccount"),children:i("APPS.INSTAGRAM.CREATE_ACCOUNT")})]}):s(B,{children:[i("APPS.INSTAGRAM.HAVE_ACCOUNT")," ",e("span",{onClick:()=>N("login"),children:i("APPS.INSTAGRAM.LOG_IN")})]})})]})})}function We(){const{Func:n,View:v,GoBack:T,Post:l}=a.useContext($),[c,d]=v,[f,M]=T,[E,m]=l,[P,t]=a.useState(""),[L,C]=a.useState(""),[u,I]=a.useState([]);a.useState([]);const[h,G]=a.useState([]),[S,V]=a.useState(0),[F,g]=a.useState(!1),[_,N]=a.useState(!1);return a.useEffect(()=>{p("Instagram",{action:"getPosts",page:0}).then(w=>{w&&G(w)})},[]),a.useEffect(()=>{const w=setTimeout(()=>t(L),500);return()=>clearTimeout(w)},[L]),a.useEffect(()=>{P.length>0&&p("Instagram",{action:"search",query:P}).then(w=>{w&&I(w)})},[P]),s("div",{className:"search-container",children:[e("div",{className:"search-header",children:e(Pe,{placeholder:"Search",onChange:w=>C(w.target.value)})}),e("div",{className:"search-body",onScroll:()=>{if(F||_||P.length>0)return;let w=document.querySelector("#last");if(!w)return;!K(w)&&(N(!0),p("Instagram",{action:"getPosts",page:S+1}).then(R=>{R&&R.length>0?(G([...h,...R]),N(!1)):g(!0)}),V(R=>R+1))},children:P.length>0?e("div",{className:"search-results",children:u.map(w=>s("div",{className:"item",onClick:()=>{n.fetchAndSetProfile(w.username)},children:[e("div",{className:"profile-picture",children:e("img",{src:n.getAvatar(w.avatar),alt:"profile"})}),s("div",{className:"user",children:[s("div",{className:"username",children:[w.username,w.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:w.name})]})]}))}):e("div",{className:"feed-grid",children:h.map((w,r)=>{let A=Math.floor(r/3)%2==0,o=!1;o=r%3==(A?1:0),h[r+1]||(o=!1);let y=JSON.parse(w.media)[0],O=r==h.length-1?"last":"";return e("div",{id:O,className:`grid-post${o?" big":""}`,onClick:()=>{M({cb:()=>{d("search"),M(null)}}),m(w),d("post")},children:q(y)?e("video",{src:y,autoPlay:!0,loop:!0,muted:!0}):e("img",{src:y,alt:"post"})},r)})})})]})}function Be(){const[n,v]=a.useState([]),[T,l]=a.useState(0),[c,d]=a.useState(!1),[f,M]=a.useState(!1);a.useEffect(()=>{p("Instagram",{action:"getNotifications"}).then(m=>{m&&v(m)})},[]);const E=()=>{if(c||f)return;let m=document.querySelector("#last");if(!m)return;!K(m)&&(M(!0),p("Instagram",{action:"getNotifications",page:T+1}).then(t=>{t&&t.length>0?(v([...n,...t]),M(!1)):d(!0)}),l(t=>t+1))};return s("div",{className:"notifications-container",children:[e("div",{className:"notifications-header",children:i("APPS.INSTAGRAM.ACTIVITY")}),e("div",{className:"notifications-body",onScroll:E,children:n.map((m,P)=>{let t=P===n.length-1?"last":"";return e($e,{notification:m,last:t},P)})})]})}const ie=n=>{var c,d;const v=new Date(n),l=(new Date-v)/1e3;return l<1?"Now":l<60?`${Math.floor(l)}s`:l<3600?`${Math.floor(l/60)}m`:l<86400?Math.floor(l/3600)+"h":l<604800?Math.floor(l/86400)+"d":`${v.getDate()} ${v.toLocaleDateString(((d=(c=ve)==null?void 0:c.value)==null?void 0:d.DateLocale)??"en-US",{month:"short"})}`},$e=({notification:n,last:v})=>{const{Account:T,Func:l}=a.useContext($),[c]=T,[d,f]=a.useState(n.isFollowing);switch(n.type){case"like_photo":return s("div",{className:"notification-item",id:v,onClick:()=>l.fetchAndSetPost(n.postId),children:[s("div",{className:"notification-body",children:[e("img",{className:"avatar",src:l.getAvatar(n.avatar),onClick:E=>{E.stopPropagation(),l.fetchAndSetProfile(n.username)}}),s("div",{className:"content",children:[e("span",{children:n.username})," ",i("APPS.INSTAGRAM.LIKED_PHOTO"),e("span",{className:"date",children:ie(n.timestamp)})]})]}),q(n.photo)?e("video",{className:"post-preview",src:n.photo,muted:!0,controls:!1}):e("img",{className:"post-preview",src:n.photo})]});case"like_comment":return e("div",{className:"notification-item",id:v,onClick:()=>l.fetchAndSetPost(n.postId,!0),children:s("div",{className:"notification-body",children:[e("img",{className:"avatar",src:l.getAvatar(n.avatar),onClick:E=>{E.stopPropagation(),l.fetchAndSetProfile(n.username)}}),s("div",{className:"content",children:[e("span",{children:n.username})," ",i("APPS.INSTAGRAM.LIKED_COMMENT").format({comment:n.comment}),e("span",{className:"date",children:ie(n.timestamp)})]})]})});case"comment":return s("div",{className:"notification-item",id:v,onClick:()=>l.fetchAndSetPost(n.postId,!0),children:[s("div",{className:"notification-body",children:[e("img",{className:"avatar",src:l.getAvatar(n.avatar),onClick:E=>{E.stopPropagation(),l.fetchAndSetProfile(n.username)}}),s("div",{className:"content",children:[e("span",{children:n.username})," ",i("APPS.INSTAGRAM.COMMENTED").format({comment:n.comment}),e("span",{className:"date",children:ie(n.timestamp)})]})]}),q(n.photo)?e("video",{className:"post-preview",src:n.photo,muted:!0,controls:!1}):e("img",{className:"post-preview",src:n.photo})]});case"follow":return s("div",{className:"notification-item",id:v,onClick:()=>l.fetchAndSetProfile(n.username),children:[s("div",{className:"notification-body",children:[e("img",{className:"avatar",src:l.getAvatar(n.avatar),onClick:()=>l.fetchAndSetProfile(n.username)}),s("div",{className:"content",children:[e("span",{children:n.username})," ",i("APPS.INSTAGRAM.FOLLOWED"),e("span",{className:"date",children:ie(n.timestamp)})]})]}),e("div",{className:`button ${d?"following":"follow"}`,onClick:E=>{E.stopPropagation(),c.username!==n.username&&(d?H.PopUp.set({title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:n.username}),buttons:[{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{p("Instagram",{action:"toggleFollow",data:{username:n.username,following:!d}}).then(m=>{f(P=>!P)})}}]}):p("Instagram",{action:"toggleFollow",data:{username:n.username,following:!d}}).then(m=>{f(P=>!P)}))},children:d?i("APPS.INSTAGRAM.FOLLOWING"):i("APPS.INSTAGRAM.FOLLOW")})]})}};function He(n){const{View:v,GoBack:T,Comments:l,Account:c,Func:d}=a.useContext($),[f]=c,[M,E]=v,[m,P]=T,[t,L]=l,[C,u]=a.useState(""),I=a.useRef(null),[h,G]=a.useState(0),[S,V]=a.useState(!1),[F,g]=a.useState(!1),_=()=>{C.length!==0&&p("Instagram",{action:"postComment",data:{postId:t.post.id,comment:C}}).then(()=>{u(""),I.current.value="",L(k=>({post:k.post,comments:[{user:{username:f.username,avatar:f.avatar,verified:f.verified},comment:{content:C,timestamp:Date.now(),likes:0,liked:!1}},...k.comments]}))})},N=()=>{if(S||F)return;let k=document.querySelector("#last");if(!k)return;!K(k)&&(g(!0),p("Instagram",{action:"getComments",postId:t.post.id,page:h+1}).then(r=>{r&&r.length>0?(L({...t,comments:[...t.comments,...r]}),g(!1)):V(!0)}),G(r=>r+1))};return s("div",{className:"comments-container",children:[s("div",{className:"comments-header",children:[e(Ae,{onClick:()=>{m&&(m!=null&&m.cb)?m.cb():E("feed")}}),e("div",{className:"title",children:i("APPS.INSTAGRAM.COMMENTS")}),e("span",{})]}),s("div",{className:"comments-body",onScroll:N,children:[s("div",{className:"post-info",children:[e("div",{className:"profile-picture",children:e("img",{src:d.getAvatar(t.post.avatar),alt:"profile"})}),s("div",{className:"post-data",children:[s("div",{className:"caption",children:[s("span",{className:"username",children:[t.post.username,t.post.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),ae(t.post.caption)]}),e("div",{className:"actions",children:e("div",{className:"date",children:Ce(t.post.timestamp)})})]})]}),t.comments.map((k,w)=>{let r=w===t.comments.length-1;return e(je,{data:k,last:r},w)})]}),s("div",{className:"add-comment",children:[e("div",{className:"profile-picture",children:e("img",{src:d.getAvatar(f.avatar),alt:"profile"})}),s("div",{className:"input-container",children:[e(Y,{type:"text",ref:I,placeholder:i("APPS.INSTAGRAM.ADD_COMMENT_AS").format({name:f.username}),onKeyPress:k=>{k.key==="Enter"&&_()},onChange:k=>u(k.target.value)}),e("div",{className:"send",onClick:_,children:i("APPS.INSTAGRAM.POST")})]})]})]})}const je=({data:n,last:v})=>{const{Func:T}=a.useContext($),[l,c]=a.useState(n.comment.liked),[d,f]=a.useState(n.comment.likes);return s("div",{className:"comment",id:v&&"last",children:[s("div",{className:"user",children:[e("div",{className:"profile-picture",onClick:()=>T.fetchAndSetProfile(n.user.username),children:e("img",{src:T.getAvatar(n.user.avatar),alt:"profile"})}),s("div",{className:"comment-data",children:[s("div",{className:"caption",children:[s("span",{className:"username",onClick:()=>T.fetchAndSetProfile(n.user.username),children:[n.user.username,n.user.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),n.comment.content]}),s("div",{className:"actions",children:[e("div",{className:"date",children:Ce(n.comment.timestamp)}),s("div",{className:"likes",children:[d," ",i("APPS.INSTAGRAM.LIKES").toLowerCase()]})]})]})]}),e(pe,{liked:l,onClick:()=>{n.comment.id&&p("Instagram",{action:"toggleLike",data:{postId:n.comment.id,toggle:!l,isComment:!0}}).then(M=>{M&&(c(M.liked),f(M.likes))})}})]})},Ce=n=>{const v=new Date(n),l=new Date-v,c=Math.floor(l/(1e3*60*60*24)),d=Math.floor(l/(1e3*60*60)),f=Math.floor(l/(1e3*60));let M="";return c<1?d<1?M=`${f}m`:M=`${d}h`:c<30?M=`${c}d`:M=`${v.getDate()}/${v.getMonth()+1}/${v.getFullYear()}`,M};function ze(){const{View:n,Post:v,GoBack:T}=a.useContext($),[l,c]=n,[d]=T,[f]=v;return e(B,{children:f&&e("div",{className:"viewpost-container",children:s(B,{children:[s("div",{className:"viewpost-header",children:[e(Ae,{onClick:()=>{d&&(d.cb?d.cb():c(d.view))}}),e("div",{className:"name",children:f.username??"Unknown"}),e("span",{})]}),e("div",{className:"profile-body",children:e(Ie,{data:f})})]})})})}function Ye(){const{View:n}=a.useContext($),[v,T]=n,[l,c]=a.useState(0),[d,f]=a.useState([]),[M,E]=a.useState(""),[m,P]=a.useState([]),[t,L]=a.useState(0),[C,u]=a.useState(!1),[I,h]=a.useState(!1);a.useEffect(()=>{p("Camera",{action:"getImages",page:0,filter:{showVideos:!0,showPhotos:!0}}).then(S=>{S&&P(S)})},[]);const G=S=>{if(I||C)return;let V=document.querySelector("#last");if(!V)return;!K(V)&&(u(!0),p("Camera",{action:"getImages",page:t+1,filter:{showVideos:!0,showPhotos:!0}}).then(g=>{g&&g.length>0?(P([...m,...g]),u(!1)):h(!0)}),L(g=>g+1))};return s("div",{className:"newpost-container","data-camera":!1,children:[l===0&&s(B,{children:[s("div",{className:"newpost-header",children:[e("i",{className:"fal fa-times",onClick:()=>{T("feed")}}),e("div",{className:"title",children:i("APPS.INSTAGRAM.NEW_POST")}),e("div",{className:"next",onClick:()=>{d.length>0&&l==0&&c(1)},children:i("APPS.INSTAGRAM.NEXT")})]}),e("div",{className:"newpost-body",onScroll:G,children:e("div",{className:"images",children:m.map((S,V)=>{let F=V===m.length-1?"last":"";return s("div",{id:F,className:"image",onClick:()=>{d.includes(S.src)?f(d.filter(_=>_!==S.src)):d.length<5&&f([...d,S.src])},children:[q(S.src)?e(qe,{src:S.src}):e("img",{src:S.src,alt:"image"}),e("div",{className:"select",children:e(_e,{checked:d.includes(S.src)})})]},V)})})})]}),l===1&&s(B,{children:[s("div",{className:"newpost-header",children:[e("i",{className:"fal fa-chevron-left",onClick:()=>{c(0)}}),e("div",{className:"title",children:i("APPS.INSTAGRAM.NEW_POST")}),e("div",{className:"next",onClick:()=>{p("Instagram",{action:"newPost",data:{caption:M,images:d}}).then(S=>{S&&T("feed")})},children:i("APPS.INSTAGRAM.POST")})]}),e("div",{className:"newpost-body",children:s("div",{className:"caption",children:[e("div",{className:"image",children:q(d[0])?e("video",{src:d[0],muted:!0}):e("img",{src:d[0],alt:"image"})}),e(Se,{onChange:S=>{E(S.target.value)},placeholder:i("APPS.INSTAGRAM.CAPTION_PLACEHOLDER")})]})})]})]})}const qe=({src:n})=>{const[v,T]=a.useState(null);return s(B,{children:[e("video",{src:n,crossOrigin:"anonymous",controls:!1,onMouseOver:c=>c.currentTarget.play(),onMouseOut:c=>c.currentTarget.pause(),onLoadedMetadata:c=>T(c.currentTarget.duration)}),v&&e("div",{className:"video-duration",children:(c=>{const d=Math.floor(c/60),f=Re(c-d*60,0);return`${d}:${f<10?"0"+f:f}`})(v)})]})};function Ke(){const{View:n,Func:v,Dm:T,Account:l,GoBack:c}=a.useContext($),[d,f]=n,[M]=l,[E,m]=T,[P,t]=c,[L,C]=a.useState(!1),[u,I]=a.useState(""),[h,G]=a.useState(""),[S,V]=a.useState([]);a.useState([]);const[F,g]=a.useState([]),[_,N]=a.useState(0),[k,w]=a.useState(!1),[r,R]=a.useState(!1);a.useEffect(()=>{p("Instagram",{action:"getRecentMessages",page:0}).then(o=>{o&&g(o)})},[]);const A=()=>{if(k||r)return;let o=document.querySelector("#last");if(!o)return;!K(o)&&(R(!0),p("Instagram",{action:"getRecentMessages",page:_+1}).then(O=>{O&&O.length>0?(g([...F,...O]),R(!1)):w(!0)}),N(O=>O+1))};return a.useEffect(()=>{const o=setTimeout(()=>I(h),500);return()=>clearTimeout(o)},[h]),a.useEffect(()=>{u.length>0?L?p("Instagram",{action:"search",query:u}).then(o=>{o&&V(o)}):V(F.filter(o=>o.username.includes(u)||o.name.includes(u)&&o.username!==M.username)):V([])},[u]),a.useEffect(()=>{I(""),V([])},[L]),e("div",{className:"dm-list",children:L?s("div",{className:"slide up",children:[s("div",{className:"dm-list-header new",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{C(!1),V([])}}),e("div",{className:"title",children:i("APPS.INSTAGRAM.NEW_MESSAGE")}),e("span",{})]}),s("div",{className:"dm-list-body ",children:[s("div",{className:"input",children:[e("span",{children:i("APPS.INSTAGRAM.TO")}),e(Y,{type:"text",onChange:o=>G(o.target.value),placeholder:"Search"})]}),S.length>0&&e("div",{className:"items",children:S.map((o,y)=>s("div",{className:"item",onClick:()=>{C(!1),m(o),f("dm")},children:[e("div",{className:"avatar",onClick:O=>{O.stopPropagation(),t({cb:()=>{f("dmList"),t(null)}}),v.fetchAndSetProfile(o.username)},children:e("img",{src:v.getAvatar(o.avatar)})}),s("div",{className:"info",children:[s("div",{className:"username",children:[o.username,o.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"last-message",children:o.name})]})]},y))})]})]}):s(B,{children:[s("div",{className:"dm-list-header",children:[s("div",{className:"top",children:[e("i",{className:"far fa-chevron-left",onClick:()=>f("feed")}),e("i",{className:"far fa-edit",onClick:()=>C(!0)})]}),e(Pe,{placeholder:i("SEARCH"),onChange:o=>G(o.target.value)})]}),e("div",{className:"dm-list-body",onScroll:A,children:e("div",{className:"items",children:u.length&&!L>0?S.map((o,y)=>{var O;return((O=o.content)==null?void 0:O.length)===0&&(o.content=i("APPS.INSTAGRAM.SENT_A_PHOTO")),s("div",{className:"item",onClick:()=>{C(!1),m(o),f("dm")},children:[e("div",{className:"avatar",onClick:D=>{D.stopPropagation(),t({cb:()=>{f("dmList"),t(null)}}),v.fetchAndSetProfile(o.username)},children:e("img",{src:v.getAvatar(o.avatar)})}),s("div",{className:"info",children:[s("div",{className:"username",children:[o.name,o.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),s("div",{className:"last-message",children:[o.content.length>40?o.content.substring(0,40)+"...":o.content," • ",le(o.timestamp)]})]})]},y)}):F.map((o,y)=>{let O=y===F.length-1;return o.content.length===0&&(o.content=i("APPS.INSTAGRAM.SENT_A_PHOTO")),s("div",{className:"item",id:O?"last":"",onClick:()=>{C(!1),m(o),f("dm")},children:[e("div",{className:"avatar",onClick:D=>{D.stopPropagation(),t({cb:()=>{f("dmList"),t(null)}}),v.fetchAndSetProfile(o.username)},children:e("img",{src:v.getAvatar(o.avatar)})}),s("div",{className:"info",children:[s("div",{className:"username",children:[o.name,o.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),o.content.length>40?o.content.substring(0,40)+"...":o.content," • ",le(o.timestamp)]})]},y)})})})]})})}function Xe(){const{Func:n,Account:v,Dm:T,View:l,GoBack:c}=a.useContext($),d=ee(te.Settings),[f]=v,[M,E]=l,[m,P]=T,[t,L]=c,[C,u]=a.useState([]),I=a.useRef(null),[h,G]=a.useState({content:"",attachments:[]}),[S,V]=a.useState(0),[F,g]=a.useState(!1),[_,N]=a.useState(!1);a.useEffect(()=>{g(!1),N(!1),V(0),u([]),p("Instagram",{action:"getMessages",page:0,username:m.username}).then(r=>{r&&u(r.reverse())})},[]),z("instagram:newMessage",r=>{if(m.username!==r.sender)return;u([...C,r]);let R=document.querySelector(".dm-body-container");R.scrollTop=R.scrollHeight});const k=()=>{h.content.length===0&&h.attachments.length===0||p("Instagram",{action:"sendMessage",username:m.username,message:{content:h.content,attachments:h.attachments.length>0?h.attachments:null}}).then(r=>{if(!r)return;I.current.value="",u([...C,{sender:f.username,recipient:m.username,content:h.content,attachments:h.attachments,timestamp:new Date}]),G({content:"",attachments:[]});let R=document.querySelector(".dm-body-container");R.scrollTop=R.scrollHeight})},w=()=>{if(F||_)return;let r=document.querySelector("#last");if(!r)return;!K(r)&&(N(!0),p("Instagram",{action:"getMessages",page:S+1,username:m.username}).then(A=>{A&&A.length>0?(u([...A.reverse(),...C]),N(!1)):g(!0)}),V(A=>A+1))};return s("div",{className:"dm-container",children:[s("div",{className:"dm-header",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{t&&t.cb?(t.cb(),L(null)):E("dmList")}}),s("div",{className:"profile",onClick:r=>{r.stopPropagation(),L({cb:()=>{P(m),E("dm")}}),n.fetchAndSetProfile(m.username)},children:[e("div",{className:"avatar",children:e("img",{src:n.getAvatar(m.avatar)})}),s("div",{className:"username",children:[m.name??m.username,m.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]})]})]}),e("div",{className:"dm-body-container",onScroll:w,children:e("div",{className:"dm-body",children:C.map((r,R)=>{var D;let A,o=R===0,y=r.sender===f.username?"self":"other",O=((D=C[R+1])==null?void 0:D.sender)===f.username?"self":"other";return C[R+1]?A=Math.abs(r.timestamp-C[R+1].timestamp)/36e5:O=void 0,s("div",{className:`message ${y}`,id:o?"last":"",children:[y=="other"?s("div",{className:"message-with-pfp",children:[e("div",{className:`profile-picture ${y!==O?"show":"hide"}`,onClick:U=>{U.stopPropagation(),L({cb:()=>{P(m),E("dm")}}),n.fetchAndSetProfile(m.username)},children:e("img",{src:n.getAvatar(m.avatar)})}),s("div",{className:"message-content",children:[r.content&&e("div",{className:"content",children:ae(r.content)}),r.attachments&&e("div",{className:"attatchments",children:r.attachments.map((U,b)=>q(U)?e("video",{src:U,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:x=>{H.FullscreenImage.set({display:!0,image:U})}},b):e(ue,{src:U,onClick:()=>{H.FullscreenImage.set({display:!0,image:U})}},b))})]})]}):s(B,{children:[r.content&&e("div",{className:"content",children:ae(r.content)}),r.attachments&&e("div",{className:"attatchments",children:r.attachments.map((U,b)=>q(U)?e("video",{src:U,controls:!1,loop:!0,muted:!0,autoPlay:!0,onClick:x=>{H.FullscreenImage.set({display:!0,image:U})}},b):e("img",{src:U,onClick:()=>{H.FullscreenImage.set({display:!0,image:U})}},b))})]}),C[R+1]&&A>6?e("div",{className:"date",children:fe(r.timestamp,d.time.twelveHourClock)}):y!==O&&e("div",{className:"date",children:fe(r.timestamp,d.time.twelveHourClock)})]},R)})})}),e("div",{className:"attachments",children:h.attachments.map((r,R)=>s("div",{className:"attachment",children:[q(r)?e("video",{src:r,muted:!0,controls:!1,loop:!0,autoPlay:!0}):e(ue,{src:r}),e(re,{onClick:()=>{G({...h,attachments:h.attachments.filter((A,o)=>o!==R)})}})]},R))}),s("div",{className:"dm-footer",children:[e(Y,{type:"text",ref:I,onChange:r=>{G({...h,content:r.target.value})},onKeyDown:r=>{r.key==="Enter"&&k()},placeholder:i("APPS.INSTAGRAM.MESSAGE_PLACEHOLDER")}),h.content.length>0?e("span",{onClick:()=>k(),className:"send",children:i("APPS.INSTAGRAM.SEND")}):e(Oe,{onClick:()=>{h.attachments.length<3&&H.Gallery.set({includeVideos:!0,onSelect:r=>G({...h,attachments:[...h.attachments,r.src]})})}})]})]})}function Je(){var R,A,o,y;const{Account:n,View:v,Func:T,Stories:l,Story:c,Dm:d}=a.useContext($),[f]=n,[M,E]=v,[m,P]=l,[t,L]=c,[C,u]=d,[I,h]=a.useState(0),[G,S]=a.useState(""),[V,F]=a.useState(!1),[g,_]=a.useState({x:0,y:0});a.useEffect(()=>{if(t){_(t.origin);for(let O=0;O<t.media.length;O++)if(!t.media[O].seen)return h(O)}},[]);const N=O=>{if(V)return F(!1);const D=O.target.getBoundingClientRect(),U=O.clientX-D.left;let b=t.media[I];if(b.seen||p("Instagram",{action:"viewedStory",id:b.id}),U<D.width/2)if(I>0)h(I-1);else{let x=m.findIndex(J=>J.username===t.username),j=m[x-1];j&&T.fetchAndSetStory(j)}else if(I<t.media.length-1)h(I+1);else{let x=m.findIndex(J=>J.username===t.username),j=m[x+1];j?(w(t.username),T.fetchAndSetStory(j),h(0)):r()}},k=()=>{!G||G===""||p("Instagram",{action:"sendMessage",username:t.username,message:{content:G}}).then(O=>{O&&(u({username:t.username,name:t.name,verified:t.verified,avatar:t.avatar}),E("dm"),r())})},w=O=>{t.media.length===I+1&&P(D=>D.map(U=>(U.username===O&&(U.seen=1),U)))},r=()=>{w(t.username),L(null)};return s(de.div,{className:"instagram-story",initial:{scale:0,transformOrigin:t!=null&&t.origin?`${((R=t==null?void 0:t.origin)==null?void 0:R.x)??0}px ${((A=t==null?void 0:t.origin)==null?void 0:A.y)??0}px`:"50% 50%"},animate:{scale:1,transformOrigin:t!=null&&t.origin?`${((o=t==null?void 0:t.origin)==null?void 0:o.x)??0}px ${((y=t==null?void 0:t.origin)==null?void 0:y.y)??0}px`:"50% 50%"},exit:{scale:0,transformOrigin:g?`${(g==null?void 0:g.x)??0}px ${(g==null?void 0:g.y)??0}px`:"50% 50%"},transition:{duration:.25,ease:"easeInOut"},children:[q(t==null?void 0:t.media[I].image)?e("video",{className:"background-image",onClick:N,autoPlay:!0,loop:!0,src:t==null?void 0:t.media[I].image}):e("div",{className:"background-image",onClick:N,style:{backgroundImage:`url(${t==null?void 0:t.media[I].image})`}}),e(oe,{children:V&&e(Qe,{activeImage:I,close:()=>F(!1)})}),s("div",{className:"story-wrapper",children:[s("div",{className:"story-header",children:[e("div",{className:"story-steps",children:t==null?void 0:t.media.map((O,D)=>e("div",{className:I===D?"active":"",onClick:()=>h(D)},D))}),s("div",{className:"profile-details",children:[s("div",{className:"profile",onClick:()=>T.fetchAndSetProfile(t.username),children:[e("div",{className:"profile-picture",style:{backgroundImage:`url(${T.getAvatar(t==null?void 0:t.avatar)})`}}),s("div",{className:"name",children:[t==null?void 0:t.username,!1]}),e("div",{className:"time",children:le(t==null?void 0:t.media[I].timestamp)})]}),e("div",{className:"stats",children:e(re,{onClick:()=>{if(t!=null&&t.media[I].seen)return r();p("Instagram",{action:"viewedStory",id:t==null?void 0:t.media[I].id}).then(O=>r())}})})]})]}),(t==null?void 0:t.username)===f.username?e("div",{className:"story-footer","data-stats":!0,children:s("div",{className:"seen-by",onClick:()=>F(!0),children:[(t==null?void 0:t.media[I].viewers)&&e("div",{className:"images",children:t==null?void 0:t.media[I].viewers.map((O,D)=>e("img",{src:T.getAvatar(O.avatar)},D))}),i("APPS.INSTAGRAM.SEEN_BY").format({count:ye(t==null?void 0:t.media[I].views)??0})]})}):s("div",{className:"story-footer",children:[e("div",{className:"input",children:e(Y,{type:"text",placeholder:i("APPS.INSTAGRAM.SEND_A_MESSAGE"),onChange:O=>S(O.target.value),onKeyDown:O=>{O.key==="Enter"&&k()}})}),e(Ge,{onClick:()=>k()})]})]})]})}const Qe=n=>{var u;const{Func:v,Story:T}=a.useContext($),[l,c]=T,[d,f]=a.useState([]),[M,E]=a.useState(0),[m,P]=a.useState(!1),[t,L]=a.useState(!1);a.useEffect(()=>{(n==null?void 0:n.activeImage)!==void 0&&p("Instagram",{action:"getViewers",id:l==null?void 0:l.media[n.activeImage].id,page:0}).then(I=>{I&&(f(I),I.length<15&&P(!0))})},[]);const C=I=>{if(m||t)return;let h=document.querySelector("#last");if(!h)return;!K(h)&&(L(!0),p("Instagram",{action:"getViewers",id:l==null?void 0:l.media[n.activeImage].id,page:M+1}).then(S=>{S&&S.length>0?(f(V=>[...V,...S]),L(!1),S.length<15&&P(!0)):P(!0)}),E(S=>S+1))};return s(de.div,{className:"story-modal",initial:{y:600},animate:{y:0},exit:{y:600},transition:{duration:.35,ease:"easeInOut"},children:[s("div",{className:"story-modal-header",children:[s("div",{className:"views",children:[e(Ne,{})," ",e("div",{className:"views",children:((u=l==null?void 0:l.media[n==null?void 0:n.activeImage])==null?void 0:u.views)??0})]}),e(re,{className:"close",onClick:n==null?void 0:n.close})]}),s("div",{className:"story-modal-content",children:[e("div",{className:"title",children:i("APPS.INSTAGRAM.STORY_VIEWERS")}),e("div",{className:"viewers",onScroll:C,children:d.map((I,h)=>{let G=h===d.length-1?"last":"";return e("div",{className:"item",id:G,children:s("div",{className:"user",onClick:()=>{v.fetchAndSetProfile(I.username),c(null)},children:[e("div",{className:"profile-picture",children:e("img",{src:v.getAvatar(I.avatar)})}),s("div",{className:"user-details",children:[s("div",{className:"username",children:[I.username,I.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:I.name})]})]})},h)})})]})]})};function Ze(){var M;const{Func:n,View:v,Account:T}=a.useContext($),l=ee(te.Settings),[c,d]=v,[f]=T;return e("div",{className:"instagram-footer",children:s(B,{children:[e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>d("feed"),children:e("g",{children:c=="feed"?e("path",{fill:l.display.theme=="dark"&&"#fafafa",d:"M22 23h-6.001a1 1 0 01-1-1v-5.455a2.997 2.997 0 10-5.993 0V22a1 1 0 01-1 1H2a1 1 0 01-1-1V11.543a1.002 1.002 0 01.31-.724l10-9.543a1.001 1.001 0 011.38 0l10 9.543a1.002 1.002 0 01.31.724V22a1 1 0 01-1 1z"}):e("path",{d:"M9.005 16.545a2.997 2.997 0 012.997-2.997h0A2.997 2.997 0 0115 16.545V22h7V11.543L12 2 2 11.543V22h7.005z",fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2"})})}),e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>d("search"),children:c=="search"?e("path",{fill:l.display.theme=="dark"&&"#fafafa",d:"M13.173 13.164l1.491-3.829-3.83 1.49zM12.001.5a11.5 11.5 0 1011.5 11.5A11.513 11.513 0 0012.001.5zm5.35 7.443l-2.478 6.369a1 1 0 01-.57.569l-6.36 2.47a1 1 0 01-1.294-1.294l2.48-6.369a1 1 0 01.57-.569l6.359-2.47a1 1 0 011.294 1.294z"}):s(B,{children:[e("polygon",{fill:"none",points:"13.941 13.953 7.581 16.424 10.06 10.056 16.42 7.585 13.941 13.953",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),e("polygon",{fillRule:"evenodd",points:"10.06 10.056 13.949 13.945 7.581 16.424 10.06 10.056"}),e("circle",{cx:"12.001",cy:"12.005",fill:"none",r:"10.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})]})}),e("svg",{color:"#262626",fill:"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>d("newPost"),children:s(B,{children:[e("path",{d:"M2 12v3.45c0 2.849.698 4.005 1.606 4.944.94.909 2.098 1.608 4.946 1.608h6.896c2.848 0 4.006-.7 4.946-1.608C21.302 19.455 22 18.3 22 15.45V8.552c0-2.849-.698-4.006-1.606-4.945C19.454 2.7 18.296 2 15.448 2H8.552c-2.848 0-4.006.699-4.946 1.607C2.698 4.547 2 5.703 2 8.552z",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),e("line",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",x1:"6.545",x2:"17.455",y1:"12.001",y2:"12.001"}),e("line",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",x1:"12.003",x2:"12.003",y1:"6.545",y2:"17.455"})]})}),c==="notifications"?e("svg",{fill:"#262626",height:"24",viewBox:"0 0 48 48",width:"24",children:e("path",{fill:l.display.theme=="dark"&&"#fafafa",d:"M34.6 3.1c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5s1.1-.2 1.6-.5c1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"})}):e("svg",{color:((M=l==null?void 0:l.display)==null?void 0:M.theme)==="dark"?"#ffffff":"#262626",fill:l.display.theme==="dark"?"#ffffff":"#262626",height:"24",viewBox:"0 0 24 24",width:"24",onClick:()=>d("notifications"),children:e("path",{color:l.display.theme=="dark"&&"#fafafa",d:"M16.792 3.904A4.989 4.989 0 0121.5 9.122c0 3.072-2.652 4.959-5.197 7.222-2.512 2.243-3.865 3.469-4.303 3.752-.477-.309-2.143-1.823-4.303-3.752C5.141 14.072 2.5 12.167 2.5 9.122a4.989 4.989 0 014.708-5.218 4.21 4.21 0 013.675 1.941c.84 1.175.98 1.763 1.12 1.763s.278-.588 1.11-1.766a4.17 4.17 0 013.679-1.938m0-2a6.04 6.04 0 00-4.797 2.127 6.052 6.052 0 00-4.787-2.127A6.985 6.985 0 00.5 9.122c0 3.61 2.55 5.827 5.015 7.97.283.246.569.494.853.747l1.027.918a44.998 44.998 0 003.518 3.018 2 2 0 002.174 0 45.263 45.263 0 003.626-3.115l.922-.824c.293-.26.59-.519.885-.774 2.334-2.025 4.98-4.32 4.98-7.94a6.985 6.985 0 00-6.708-7.218z"})}),e("img",{src:n.getAvatar(f.avatar),className:"profile",alt:"profile",onClick:()=>n.fetchAndSetProfile(f.username)})]})})}function et(n){const{Account:v,UserPanel:T,GoBack:l}=a.useContext($),[c,d]=T,[f,M]=a.useState([]),[E,m]=a.useState(0),[P,t]=a.useState(!1),[L,C]=a.useState(!1);let u={Following:"getFollowing",Followers:"getFollowers","Liked by":"getLikes"};a.useEffect(()=>{p("Instagram",{action:u[c.data.title],data:{postId:c.data.postId,username:c.data.username,page:0}}).then(h=>{h&&M(h)})},[]);const I=h=>{if(P||L)return;!K(document.querySelector("#last"))&&(C(!0),p("Instagram",{action:u[c.data.title],data:{postId:c.data.postId,username:c.data.username,page:E+1}}).then(S=>{S&&S.length>0?(M([...f,...S]),C(!1)):t(!0)}),m(S=>S+1))};return e(B,{children:c.data&&f&&s("div",{className:"userpanel-container",children:[s("div",{className:"userpanel-header",children:[e("i",{className:"far fa-chevron-left",onClick:()=>{var h;(h=c.data)==null||h.cb()}}),e("div",{className:"userpanel-title",children:c.data.title}),e("span",{})]}),e("div",{className:"userpanel-body",onScroll:I,children:e("div",{className:"items",children:f.map((h,G)=>{let S=G===f.length-1;return e(tt,{data:h,allData:c.data,last:S},G)})})})]})})}const tt=n=>{const{Func:v,Account:T,GoBack:l,UserPanel:c}=a.useContext($),[d]=T,[f,M]=l,[E,m]=c;let P=n.data,t=n.last;const[L,C]=a.useState(P.isFollowing===1);return s("div",{className:"item",id:t?"last":"",onClick:()=>{M({cb:()=>{m({display:!0,data:n.allData})}}),v.fetchAndSetProfile(P.username)},children:[s("div",{className:"user",children:[e("div",{className:"profile-picture",children:e("img",{src:v.getAvatar(P.avatar),alt:"profile"})}),s("div",{className:"user-details",children:[s("div",{className:"username",children:[P.username,P.verified&&e("span",{className:"verified",children:e("img",{src:"./assets/img/icons/instagram/Verified.svg"})})]}),e("div",{className:"name",children:P.name})]})]}),d.username!==P.username&&e("div",{className:"action",onClick:u=>{u.stopPropagation(),P.username!==d.username&&(L?H.PopUp.set({title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.TITLE"),description:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.DESCRIPTION").format({name:P.username}),buttons:[{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.CANCEL")},{title:i("APPS.INSTAGRAM.UNFOLLOW_POPUP.PROCEED"),color:"red",cb:()=>{p("Instagram",{action:"toggleFollow",data:{username:P.username,following:!L}}).then(I=>{C(h=>!h)})}}]}):p("Instagram",{action:"toggleFollow",data:{username:P.username,following:!L}}).then(I=>{C(h=>!h)}))},children:L?e("div",{className:"button following",children:i("APPS.INSTAGRAM.FOLLOWING")}):e("div",{className:"button follow",children:i("APPS.INSTAGRAM.FOLLOW")})})]})},$=a.createContext(null);function rt(){const{Func:n}=a.useContext(Ve),v=ee(te.Settings),[T,l]=n.TextColor,[c,d]=a.useState("feed"),[f,M]=a.useState({}),[E,m]=a.useState(!1),[P,t]=a.useState(null),[L,C]=a.useState(null),[u,I]=a.useState(null),[h,G]=a.useState(null),[S,V]=a.useState([]),[F,g]=a.useState(null),[_,N]=a.useState(null),[k,w]=a.useState({display:!1,data:{}}),[r,R]=a.useState(!0);a.useEffect(()=>{p("isAdmin").then(b=>{if(Q.APPS.INSTAGRAM.account.value){M({...Q.APPS.INSTAGRAM.account.value,isAdmin:b}),m(!0),R(!1);return}else if(Q.APPS.INSTAGRAM.account.value===!1)return R(!1);p("Instagram",{action:"isLoggedIn"}).then(x=>{x?(Q.APPS.INSTAGRAM.account.set(x),M({...x,isAdmin:b}),m(!0),R(!1)):(Q.APPS.INSTAGRAM.account.set(!1),R(!1))})})},[]),a.useEffect(()=>{setTimeout(()=>{c==="live"||c==="newPost"||c==="story"?(l("#fafafaed"),c=="live"&&H.IndicatorVisible.set(!1)):(l(v.display.theme==="dark"?"#fafafaed":"#000000"),H.IndicatorVisible.set(!0)),c==="dm"?se.ReceiveAppNotifications.set(!1):se.ReceiveAppNotifications.set(!0)},250)},[c]);const A=(b,x)=>{b&&p("Instagram",{action:"getPost",id:b}).then(j=>{if(j){if(x)return y(j);g(j),d("post")}})},o=b=>{b&&p("Instagram",{action:"getProfile",username:b}).then(x=>{x&&(C(x),d("profile"))})},y=b=>{b.id&&p("Instagram",{action:"getComments",postId:b.id,page:0}).then(x=>{x&&(G({post:b,comments:x}),d("comments"))})},O=(b,x,j)=>{!b&&!(b!=null&&b.username)||((x==null?void 0:x.length)==0&&(x=void 0),p("Instagram",{action:"getStory",username:b.username}).then(J=>{J&&t({username:b.username,avatar:b.avatar,verified:b.verified,media:J,queue:x,origin:j})}))},D=b=>b||"./assets/img/icons/instagram/unknown-pfp.jpg",U={feed:e(Fe,{}),search:e(We,{}),notifications:e(Be,{}),profile:e(xe,{data:L}),live:e(De,{}),logIn:e(he,{}),comments:e(He,{}),post:e(ze,{}),newPost:e(Ye,{}),userpanel:e(et,{}),dmList:e(Ke,{}),dm:e(Xe,{})};return a.useEffect(()=>{k.display&&d("userpanel")},[k]),e("div",{className:"instagram-container",children:e($.Provider,{value:{View:[c,d],Account:[f,M],Profile:[L,C],Post:[F,g],Comments:[h,G],LoggedIn:[E,m],GoBack:[_,N],UserPanel:[k,w],Dm:[u,I],Stories:[S,V],Story:[P,t],Func:{fetchAndSetProfile:o,fetchAndSetStory:O,fetchAndSetComments:y,fetchAndSetPost:A,getAvatar:D}},children:r||v.airplaneMode?e("div",{className:"loading",children:e(be,{size:55,speed:.9,color:T})}):e("div",{className:"instagram-wrapper",children:E?s(B,{children:[e(oe,{children:P&&e(Je,{})}),U[c],c!=="live"&&c!=="logIn"&&c!=="newPost"&&c!=="comments"&&!P&&e(Ze,{})]}):e(he,{})})})})}export{$ as InstagramContext,rt as default};

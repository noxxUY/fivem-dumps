import{R as O,r as o,a as c,j as e,F}from"./jsx-runtime-7cf68bf7.js";import{f as L,L as u,o as $,m as fe,u as X,Q as Pe,j as ye,bw as K,b3 as J,U as ie,C as H,ah as ve,a6 as Ne,h as z,b as Q,H as pe,q as Se,bx as be,Z as le,T as te,$ as Ie,a0 as de,ar as Me,by as Te,Y as Ce,S as he}from"./Phone-ec5c0d3e.js";import{a as Ae}from"./DotSpinner-3c5cddfa.js";var ce=function(a){return new Promise(function(i){setTimeout(i,a)})};const k={snapBackDuration:300,maxTilt:5,bouncePower:.1,swipeThreshold:100},De=t=>{const a=window.getComputedStyle(t),i=a.getPropertyValue("width"),n=Number(i.split("px")[0]),h=a.getPropertyValue("height"),N=Number(h.split("px")[0]);return{x:n,y:N}},ue=(t,a)=>Math.sqrt(Math.pow(t,2)+Math.pow(a,2)),Re=(t,a=1)=>{const i=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2));return{x:t.x*a/i,y:t.y*a/i}},se=async(t,a,i=!1)=>{const n=Z(t),h=De(document.body),N=ue(h.x,h.y),E=ue(a.x,a.y),I=N/E,S=N/E,b=re(a.x*S+n.x,-a.y*S+n.y);let T="";const m=200;i?t.style.transition="ease "+I+"s":t.style.transition="ease-out "+I+"s",Y(t)===0?T=j((Math.random()-.5)*m):Y(t)>0?T=j(Math.random()*m/2+Y(t)):T=j((Math.random()-1)*m/2+Y(t)),t.style.transform=b+T,await ce(I*1e3)},me=async t=>{t.style.transition=k.snapBackDuration+"ms";const a=Z(t),i=re(a.x*-k.bouncePower,a.y*-k.bouncePower),n=j(Y(t)*-k.bouncePower);t.style.transform=i+n,await ce(k.snapBackDuration*.75),t.style.transform="none",await ce(k.snapBackDuration),t.style.transition="10ms"},ge=t=>{if(Math.abs(t.x)>Math.abs(t.y)){if(t.x>k.swipeThreshold)return"right";if(t.x<-k.swipeThreshold)return"left"}else{if(t.y>k.swipeThreshold)return"up";if(t.y<-k.swipeThreshold)return"down"}return"none"},Ee=(t,a)=>{const i=a.x-t.x,n=t.y-a.y,h=(a.time-t.time)/1e3;return{x:i/h,y:n/h}},re=(t,a)=>"translate("+t+"px)",j=t=>"rotate("+t+"deg)",Z=t=>{const a=window.getComputedStyle(t),i=new DOMMatrix(a.transform);return{x:i.m41,y:-i.m42}},Y=t=>{const a=window.getComputedStyle(t),i=new DOMMatrix(a.transform);return-Math.asin(i.m21)/(2*Math.PI)*360},xe=(t,a,i,n)=>{const h={x:t.x+i.x,y:t.y+i.y},N={x:h.x,y:h.y,time:new Date().getTime()},E=re(h.x),I=Ee(n,N).x/1e3,S=j(I*k.maxTilt);return a.style.transform=E+S,N},ne=t=>{const a=t.targetTouches[0];return{x:a.clientX,y:a.clientY}},ae=t=>({x:t.clientX,y:t.clientY}),ke=O.forwardRef(({flickOnSwipe:t=!0,children:a,onSwipe:i,onCardLeftScreen:n,className:h,preventSwipe:N=[],swipeRequirementType:E="velocity",swipeThreshold:I=k.swipeThreshold,onSwipeRequirementFulfilled:S,onSwipeRequirementUnfulfilled:b},T)=>{k.swipeThreshold=I;const m=O.useRef(!1),l=O.useRef();O.useImperativeHandle(T,()=>({async swipe(d="right"){i&&i(d);const s=1e3,g=(Math.random()-.5)*100;d==="right"?await se(l.current,{x:s,y:g},!0):d==="left"&&await se(l.current,{x:-s,y:g},!0),l.current.style.display="none",n&&n(d)},async restoreCard(){l.current.style.display="block",await me(l.current)}}));const p=O.useCallback(async(d,s)=>{if(m.current)return;m.current=!0;const g=Z(d),C=ge(E==="velocity"?s:g);if(C!=="none"&&(i&&i(C),t&&!N.includes(C))){const P=E==="velocity"?s:Re(g,600);await se(d,P),d.style.display="none",n&&n(C);return}me(d)},[m,t,i,n,N,E]),y=O.useCallback(()=>{m.current=!1},[m]);return O.useLayoutEffect(()=>{let d={x:null,y:null},s={x:0,y:0},g={x:0,y:0,time:new Date().getTime()},C=!1,P="none";l.current.addEventListener("touchstart",v=>{v.preventDefault(),y(),d={x:-ne(v).x,y:-ne(v).y}}),l.current.addEventListener("mousedown",v=>{v.preventDefault(),C=!0,y(),d={x:-ae(v).x,y:-ae(v).y}});const M=v=>{if(S||b){const w=ge(E==="velocity"?s:Z(l.current));w!==P&&(P=w,P==="none"?b&&b():S&&S(w))}const r=xe(v,l.current,d,g);s=Ee(g,r),g=r};l.current.addEventListener("touchmove",v=>{v.preventDefault(),M(ne(v))}),l.current.addEventListener("mousemove",v=>{v.preventDefault(),C&&M(ae(v))}),l.current.addEventListener("touchend",v=>{v.preventDefault(),p(l.current,s)}),l.current.addEventListener("mouseup",v=>{C&&(v.preventDefault(),C=!1,p(l.current,s))}),l.current.addEventListener("mouseleave",v=>{C&&(v.preventDefault(),C=!1,p(l.current,s))})},[]),O.createElement("div",{ref:l,className:h},a)});function oe(){const{View:t}=o.useContext(U),[a,i]=t;return c("div",{className:"home-header",children:[e("img",{src:"./assets/img/icons/tinder/profile.svg",onClick:()=>i("profile")}),e("img",{className:"logo",src:"./assets/img/icons/tinder/logo.svg",onClick:()=>i("home")}),e("img",{src:"./assets/img/icons/tinder/messages.svg",onClick:()=>i("messageList")})]})}function Le(){const{View:t,User:a}=o.useContext(U),[i,n]=t,[h,N]=a,[E,I]=o.useState([]),[S,b]=o.useState(0),[T,m]=o.useState(),l=o.useRef(S),p=o.useRef(0),[y,d]=o.useState(0),[s,g]=o.useState(0),[C,P]=o.useState(!1),[M,v]=o.useState(null);let[r,w]=o.useState("");o.useEffect(()=>{L("Tinder",{action:"getFeed",page:0}).then(f=>{f&&f.length>0?(I(f),b(f.length-1),p.current=f.length,d(Array(f.length).fill(0).map(A=>O.createRef()))):P(!0)})},[]);const D=f=>{b(f),l.current=f},R=S<E.length-1,W=S>=0,B=(f,A,V)=>{m(f),D(V-1),_(),f==="right"?L("Tinder",{action:"swipe",like:!0,number:A.number}).then(we=>{we&&v(A)}):f==="left"&&L("Tinder",{action:"swipe",like:!1,number:A.number})},q=(f,A)=>{l.current>=A&&y[A].current.restoreCard()},G=async f=>{W&&S<E.length&&(await y[S].current.swipe(f),_())},x=async()=>{var A,V;if(!R)return;const f=S+1;D(f),await((V=(A=y[f])==null?void 0:A.current)==null?void 0:V.restoreCard())},_=()=>{if(p.current>1){p.current=p.current-1;return}L("Tinder",{action:"getFeed",page:s+1}).then(f=>{if(f)if(f&&f.length>0){g(s+1);let A=f.length+E.length;I(V=>(V=[...V,...f],V)),p.current=f.length,b(A-1),d(Array(A).fill(0).map(V=>O.createRef()))}else P(!0)})};return c("div",{className:`home-wrapper slide ${i=="profile"?"left":"right"}`,children:[e(oe,{}),M&&c("div",{className:"match",style:{backgroundImage:`url(${M.photos[0]})`},children:[e("img",{className:"match-image",src:"./assets/img/icons/tinder/match.png"}),c("div",{className:"likes-too",children:[M.name," ",u("APPS.TINDER.LIKES_YOU_TOO").toLowerCase()]}),c("div",{className:"input",children:[e($,{type:"text",placeholder:u("APPS.TINDER.SAY_SOMETHING_NICE"),onChange:f=>w(f.target.value)}),e("div",{className:"send",onClick:()=>{L("Tinder",{action:"sendMessage",data:{recipient:M.number,content:r}}).then(f=>{f&&(N(M),n("message"))})},children:u("APPS.TINDER.SEND")})]}),e("div",{className:"keep-swiping",onClick:()=>{v(null)},children:u("APPS.TINDER.KEEP_SWIPING")})]}),c("div",{className:"home-body",children:[c("div",{className:"cards",children:[C&&e("div",{className:"card no-more",children:e("div",{children:u("APPS.TINDER.NO_MORE")})}),E.map((f,A)=>e(ke,{ref:y[A],className:"swipe",onSwipe:V=>B(V,f,A),onCardLeftScreen:()=>q(f,A),children:e(Ve,{user:f})},A))]}),c("div",{className:"actions",children:[e("div",{className:"button red",onClick:()=>G("left"),children:e("img",{src:"./assets/img/icons/tinder/close.svg"})}),e("div",{className:`button yellow small ${R?"":"disabled"}`,onClick:()=>x(),children:e("img",{src:"./assets/img/icons/tinder/undo.svg"})}),e("div",{className:"button green",onClick:()=>G("right"),children:e("img",{src:"./assets/img/icons/tinder/heart.svg"})})]})]})]})}const Ve=t=>{let a=t.user;const[i,n]=o.useState(0),[h,N]=o.useState(0);return o.useEffect(()=>{N(ee(a.dob))},[a]),c("div",{className:"card",style:{backgroundImage:`url(${a.photos[i]})`},onClick:E=>{i<a.photos.length-1?n(i+1):n(0)},children:[a.photos.length>1&&e("div",{className:"image-count",children:a.photos.map((E,I)=>e("div",{className:`image ${I==i?"active":""}`,onClick:S=>{S.stopPropagation(),n(I)}}))}),c("div",{className:"card-content",children:[c("div",{className:"name",children:[a.name," ",e("span",{children:h})]}),e("div",{className:"description",children:a.bio})]})]})};function Oe(){const{Func:t}=o.useContext(fe),{LoggedIn:a,Account:i}=o.useContext(U),n=X(Q.PhoneNumber),[h,N]=t.TextColor,[E,I]=i,[S,b]=a,[T,m]=o.useState("notLoggedIn"),[l,p]=o.useState(0),[y,d]=o.useState({});o.useEffect(()=>{T=="notLoggedIn"?N("#ffffff"):N("#000000")},[T]);const[s,g]=o.useState({name:null,photos:[],dob:{day:"",month:"",year:""},bio:null,showMen:!1,showWomen:!1}),C=P=>{var M,v,r;switch(P){case 0:let w=new Date(`${(M=s.dob)==null?void 0:M.year}/${(v=s.dob)==null?void 0:v.month}/${(r=s.dob)==null?void 0:r.day}`);if(w.isValid()){let D=ee(w);s.name&&s.name.length>=2&&D>=18&&D<=100&&(g({...s,dob:w.getTime()}),p(P+1))}case 1:s.photos.length>0&&p(P+1);case 2:s.bio&&s.bio.length>=10&&p(P+1);case 3:(s.showMen||s.showWomen)&&p(P+1);case 4:(s.isMale==!0||s.isMale==!1)&&L("Tinder",{action:"createAccount",data:{...s,dob:new Date(s.dob).toISOString().split("T")[0]}}).then(D=>{D&&(z.APPS.TINDER.account.set(s),I(s),b(!0))})}};return Date.prototype.isValid=function(){return this.getTime()===this.getTime()},e("div",{className:"login-container",style:{background:T==="notLoggedIn"?"linear-gradient(45deg, #fd267a, #ff6036)":"#ffffff"},children:T==="notLoggedIn"?c(F,{children:[e("svg",{className:"logo",viewBox:"0 0 519 123",children:c("g",{fill:"none",fillRule:"evenodd",children:[e("title",{children:u("APPS.TINDER.TITLE")}),e("path",{d:"M31.5 49.6C55 41.5 59 20.4 56 1c0-.7.6-1.2 1.2-1C79.7 11 105 35 105 71c0 27.6-21.4 52-52.5 52a50 50 0 0 1-28.2-92.7c.6-.4 1.4 0 1.4.7.3 3.7 1.3 13 5.4 18.6h.4z",fill:"#ffffff"}),e("path",{d:"M171.2 101.1l1.7-2 5.3 16.8-.7.7c-4 3.7-10 5.6-17.7 5.6h-.3c-7 0-12.5-2-16.3-5.7-3.8-3.8-5.8-9.5-5.8-16.7V54h-13.5V35.5h13.5V13.2h20.8v22.3h16.5V54h-16.6v41.3c0 1.9.5 8 6.3 8 3 0 5.8-1.1 6.8-2.3zm11 19.2V35.6H203v84.7h-20.8zM192.5 1A12.5 12.5 0 1 1 180 13.6C180 6.8 185.7 1 192.5 1zm66.4 32.5c18 0 27.9 9.8 27.9 27.7v59H266V66.2c-.4-9.6-5-14-14.8-14-8.8 0-15.9 5.4-19.5 10v58h-20.8V35.7h20.8v9c6-5.8 15.6-11 27.2-11zM356 44.4V4.6h20.8v115.8H356v-8.8a34.3 34.3 0 0 1-24.7 10.7c-22.7 0-37.9-17.8-37.9-44.3 0-26.6 15.2-44.4 37.9-44.4A34 34 0 0 1 356 44.4zm0 17.9a25.6 25.6 0 0 0-19.6-10c-12.9 0-21.5 10.3-21.5 25.7 0 15.3 8.6 25.6 21.5 25.6 7.5 0 15.7-4 19.6-9.8V62.3zm69.4-28.7c24.6 0 41.7 19 41.7 46v5.7h-62.9c2.1 11.9 11.5 19.5 24.3 19.5 8.1 0 17-3.5 22.1-8.6L452 95l9.9 14.2-1 .9a48.6 48.6 0 0 1-34.1 12.2c-26 0-44.3-18.3-44.3-44.4a42.8 42.8 0 0 1 43-44.3zm-21.3 36h42.7c-1.2-12.7-11.7-18.5-21.4-18.5-14.6 0-20.1 11-21.3 18.6zm113.3-36h1.5v21l-1.8-.3c-1.5-.3-3.4-.5-5.3-.5-6.7 0-16 4.7-19.5 9.7v56.7h-20.8V35.6h20.9V45c6.9-7.2 16-11.4 25-11.4z",fill:"#ffffff"})]})}),c("div",{className:"buttons",children:[e("div",{className:"disclamer",children:u("APPS.TINDER.AGREE_TERMS")}),e("div",{className:"button create",onClick:()=>{m("createAccount")},children:u("APPS.TINDER.CREATE_ACCOUNT")})]})]}):c("div",{className:"create-account",children:[e(Pe,{className:"chevron",onClick:()=>{l>0?p(l-1):m("notLoggedIn")}}),l==0&&c(F,{children:[e("div",{className:"title",children:u("APPS.TINDER.CREATE_ACCOUNT")}),c("div",{className:"form-body",children:[e($,{defaultValue:ye(n),type:"text",disabled:!0}),e($,{placeholder:"Name",type:"text",maxLength:25,onChange:P=>{g({...s,name:P.target.value}),P.target.value.length>=3?d({...y,name:!0}):d({...y,name:!1})}}),c("div",{className:"dob",children:[c("div",{className:"inputs",children:[e($,{placeholder:"MM",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:2,maxLength:2,onChange:P=>{g({...s,dob:{...s.dob,month:P.target.value}})}}),e("span",{children:"/"}),e($,{placeholder:"DD",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:2,maxLength:2,onChange:P=>{g({...s,dob:{...s.dob,day:P.target.value}})}}),e("span",{children:"/"}),e($,{placeholder:"YYYY",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:4,maxLength:4,onChange:P=>{var w,D,R;let M={...s,dob:{...s.dob,year:P.target.value}};g(M);let v=new Date(`${(w=M.dob)==null?void 0:w.year}/${(D=M.dob)==null?void 0:D.month}/${(R=M.dob)==null?void 0:R.day}`),r=ee(v);r>=18&&r<100?d({...y,18:!0}):d({...y,18:!1})}})]}),e("div",{className:"disclamer",children:u("APPS.TINDER.AGE_PUBLIC")}),c("div",{className:"requirement",children:[y[18]?e(K,{className:"green"}):e(J,{className:"red"}),u("APPS.TINDER.BE_OVER_18")]}),c("div",{className:"requirement",children:[y.name?e(K,{className:"green"}):e(J,{className:"red"}),u("APPS.TINDER.NAME_MINIMUM")]})]})]})]}),l==1&&c(F,{children:[e("div",{className:"title",children:u("APPS.TINDER.ADD_PHOTOS")}),e("div",{className:"photo-grid",children:[...Array(6)].map((P,M)=>{var r;let v=((r=s.photos)==null?void 0:r[M-1])||M==0;return s.photos[M]?e("div",{className:"photo",style:{backgroundImage:`url(${s.photos[M]})`},children:e("div",{className:"button remove",onClick:()=>{let w=s.photos;w.splice(M,1),g({...s,photos:w}),w.length==0&&d({...y,photos:!1})},children:e(ie,{})})}):e("div",{className:"photo",children:v&&e("div",{className:"button add",onClick:()=>{H.Gallery.set({onSelect:w=>g({...s,photos:[...s.photos,w.src]})}),d({...y,photos:!0})},children:e(ve,{})})})})}),c("div",{className:"requirement",children:[y.photos?e(K,{className:"green"}):e(J,{className:"red"}),u("APPS.TINDER.PHOTOS_MINIMUM")]})]}),l==2&&c(F,{children:[e("div",{className:"title",children:u("APPS.TINDER.DESCRIPTION")}),e(Ne,{placeholder:"Description",maxLength:200,onChange:P=>{g({...s,bio:P.target.value}),P.target.value.length>=10?d({...y,bio:!0}):d({...y,bio:!1})}}),c("div",{className:"requirement",children:[y.bio?e(K,{className:"green"}):e(J,{className:"red"}),u("APPS.TINDER.DESCRIPTION_MINIMUM")]})]}),l==3&&c(F,{children:[e("div",{className:"title",children:u("APPS.TINDER.SHOW_ME")}),c("div",{className:"showme",children:[e("div",{className:`button border ${s.showWomen&&!s.showMen?"active":""}`,onClick:()=>{g({...s,showMen:!1,showWomen:!0})},children:u("APPS.TINDER.WOMEN")}),e("div",{className:`button border ${s.showMen&&!s.showWomen?"active":""}`,onClick:()=>{g({...s,showMen:!0,showWomen:!1})},children:u("APPS.TINDER.MEN")}),e("div",{className:`button border ${s.showMen&&s.showWomen?"active":""}`,onClick:()=>{g({...s,showMen:!0,showWomen:!0})},children:u("APPS.TINDER.EVERYONE")})]})]}),l==4&&c(F,{children:[e("div",{className:"title",children:u("APPS.TINDER.I_AM")}),c("div",{className:"showme",children:[e("div",{className:`button border ${s.isMale===!0?"active":""}`,onClick:()=>{g({...s,isMale:!0})},children:u("APPS.TINDER.MALE")}),e("div",{className:`button border ${s.isMale===!1?"active":""}`,onClick:()=>{g({...s,isMale:!1})},children:u("APPS.TINDER.FEMALE")})]})]}),e("div",{className:"button gradient",onClick:()=>C(l),children:u("APPS.TINDER.CONTINUE")})]})})}function _e(){const{Account:t}=o.useContext(U),[a,i]=t,[n,h]=o.useState(a);return c("div",{className:"home-wrapper slide right",style:{backgroundColor:"#F6F6F6"},children:[e(oe,{}),c("div",{className:"profile-body",children:[c("div",{className:"user",children:[e("img",{className:"profile-picture",src:n.photos[0]}),c("div",{className:"name",children:[n.name,", ",ee(n.dob)]})]}),c("div",{className:"inputs",children:[c("div",{className:"input",children:[e("div",{className:"label",children:u("APPS.TINDER.NAME")}),e($,{type:"text",defaultValue:n.name,maxLength:10,onChange:N=>{h({...n,name:N.target.value})}})]}),c("div",{className:"input center",children:[e("div",{className:"label",children:u("APPS.TINDER.PHOTOS")}),e("div",{className:"photo-grid",children:[...Array(6)].map((N,E)=>{var S;let I=((S=n.photos)==null?void 0:S[E-1])||E==0;return n.photos[E]?e("div",{className:"photo",style:{backgroundImage:`url(${n.photos[E]})`},children:e("div",{className:"photo-button remove",onClick:()=>{let b=n.photos;b.splice(E,1),h({...n,photos:b})},children:e(ie,{})})},E):e("div",{className:"photo",children:I&&e("div",{className:"photo-button add",onClick:()=>{H.Gallery.set({onSelect:b=>h({...n,photos:[...n.photos,b.src]})})},children:e(ve,{})})})})})]}),c("div",{className:"input",children:[e("div",{className:"label",children:u("APPS.TINDER.ABOUT_ME")}),e(Ne,{type:"text",defaultValue:n.bio,maxLength:100,onChange:N=>{h({...n,bio:N.target.value})}})]}),c("div",{className:"input",children:[e("div",{className:"label",children:u("APPS.TINDER.INTERESTED_IN")}),c("select",{value:n.showMen&&n.showWomen?"Everyone":n.showMen?"Men":"Women",onChange:N=>{switch(N.target.value){case"Everyone":h({...n,showMen:!0,showWomen:!0});break;case"Men":h({...n,showMen:!0,showWomen:!1});break;case"Women":h({...n,showMen:!1,showWomen:!0});break}},children:[e("option",{value:"Men",children:u("APPS.TINDER.MEN")}),e("option",{value:"Women",children:u("APPS.TINDER.WOMEN")}),e("option",{value:"Everyone",children:u("APPS.TINDER.EVERYONE")})]})]}),c("div",{className:"input",children:[e("div",{className:"label",children:u("APPS.TINDER.GENDER")}),c("select",{value:n.isMale?"male":"female",onChange:N=>{N.target.value=="male"?h({...n,isMale:!0}):h({...n,isMale:!1})},children:[e("option",{value:"male",children:u("APPS.TINDER.MALE")}),e("option",{value:"female",children:u("APPS.TINDER.FEMALE")})]})]})]}),e("div",{className:"button gradient",onClick:()=>{n.name.length>=2&&n.bio.length>=5&&n.photos.length>=1?L("Tinder",{action:"saveProfile",data:n}).then(N=>{N&&i(n)}):console.log("issue saving tinder profile?")},children:u("APPS.TINDER.SAVE")})]})]})}function $e(){const{Func:t}=o.useContext(fe),{View:a,User:i}=o.useContext(U),[n,h]=t.TextColor,[N,E]=i,[I,S]=a,[b,T]=o.useState({newMatches:[],messages:[]});return o.useEffect(()=>{h("#000000"),L("Tinder",{action:"getMatches"}).then(m=>{m&&T(m)})},[]),pe("tinder:newMessage",m=>{let l=m.sender,p=JSON.parse(JSON.stringify(b)),y=p.messages.findIndex(d=>d.number===l);if(y!==-1)p.messages.unshift(p.messages.splice(y,1)[0]);else if(y=p.newMatches.findIndex(d=>d.number===l),y!==-1)p.messages.unshift(p.newMatches.splice(y,1)[0]);else return;p.messages[0].lastMessage=m.content,T(p)}),c("div",{className:"home-wrapper slide left",children:[e(oe,{}),e(Se,{placeholder:u("APPS.TINDER.SEARCH_MATCHES")}),c("div",{className:"message-list-body",children:[c("div",{className:"new-matches",children:[c("div",{className:"title",children:[u("APPS.TINDER.NEW_MATCHES"),b.newMatches.length>0&&e("span",{children:b.newMatches.length})]}),e("div",{className:"matches",children:b.newMatches.map((m,l)=>{var p;return c("div",{className:"new-match",onClick:()=>{E(m),S("message")},children:[e("img",{className:"profile-picture",src:(p=m.photos)==null?void 0:p[0]}),e("div",{className:"name",children:m.name})]},l)})})]}),c("div",{className:"recent-messages",children:[e("div",{className:"title",children:u("APPS.TINDER.MESSAGES")}),e("div",{className:"messages",children:b.messages.map((m,l)=>{var p;return m.lastMessage.length===0&&(m.lastMessage=u("APPS.MESSAGES.SENT_A_PHOTO")),c("div",{className:"message",onClick:()=>{E(m),S("message")},children:[e("img",{className:"profile-picture",src:(p=m.photos)==null?void 0:p[0]}),c("div",{className:"user",children:[e("div",{className:"name",children:m.name}),e("div",{className:"message",children:m.lastMessage.length>40?m.lastMessage.substring(0,40)+"...":m.lastMessage})]})]},l)})})]})]})]})}function Fe(){var v;const{View:t,User:a}=o.useContext(U),i=X(Q.Settings),n=X(Q.PhoneNumber),[h,N]=a,[E,I]=t,[S,b]=o.useState(0),[T,m]=o.useState(!1),[l,p]=o.useState(!1),y=o.useRef(null),[d,s]=o.useState({content:"",attachments:[]}),[g,C]=o.useState([]);o.useEffect(()=>{L("Tinder",{action:"getMessages",page:0,number:h.number}).then(r=>{r&&r.length>0?C(r.reverse()):m(!0)})},[]);const P=()=>{if(d.content.length===0&&d.attachments.length===0)return;const r={sender:n,recipient:h.number,content:d.content,attachments:d.attachments,timestamp:new Date};L("Tinder",{action:"sendMessage",data:r}).then(w=>{w&&(y.current.value="",s({content:"",attachments:[]}),C([...g,r]))})};o.useEffect(()=>{let r=document.querySelector(".message-container");r.scrollTop=r.scrollHeight},[g]);const M=r=>{if(T||l)return;let w=document.querySelector("#last");if(!w)return;!Ce(w)&&(p(!0),L("Tinder",{action:"getMessages",page:S+1,number:h.number}).then(R=>{R&&R.length>0?(C([...R.reverse(),...g]),p(!1)):m(!0)}),b(R=>R+1))};return pe("tinder:newMessage",r=>{h.number===r.sender&&C([...g,r])}),c("div",{className:"home-wrapper slide left",children:[c("div",{className:"message-header",children:[e(be,{onClick:()=>{I("messageList"),N(null)}}),c("div",{className:"user",children:[e("img",{className:"profile-picture",src:(v=h.photos)==null?void 0:v[0]}),e("div",{className:"name",children:h.name})]})]}),e("div",{className:"message-container",onScroll:M,children:e("div",{className:"message-body",children:g.map((r,w)=>{var q,G;let D,R=w===0?"last":"",W=r.sender===n?"self":"other",B=((q=g[w+1])==null?void 0:q.sender)===n?"self":"other";return g[w+1]?D=Math.abs(r.timestamp-g[w+1].timestamp)/36e5:B=void 0,c("div",{className:`message ${W}`,id:R,children:[W=="other"?c("div",{className:"message-with-pfp",children:[e("div",{className:`profile-picture ${W!==B?"show":"hide"}`,children:e("img",{src:(G=h.photos)==null?void 0:G[0]})}),c("div",{className:"message-content",children:[r.content&&e("div",{className:"content",children:le(r.content)}),r.attachments.length>0&&e("div",{className:"attatchments",children:r.attachments.map((x,_)=>te(x)?e("video",{src:x,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:f=>{H.FullscreenImage.set({display:!0,image:x})}},_):e(Ie,{src:x,onClick:()=>{H.FullscreenImage.set({display:!0,image:x})}},_))})]})]}):c(F,{children:[r.content&&e("div",{className:"content",children:le(r.content)}),r.attachments.length>0&&e("div",{className:"attatchments",children:r.attachments.map((x,_)=>te(x)?e("video",{src:x,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:()=>{H.FullscreenImage.set({display:!0,image:x})}},_):e("img",{src:x,onClick:()=>{H.FullscreenImage.set({display:!0,image:x})}},_))})]}),g[w+1]&&D>6?e("div",{className:"date",children:de(r.timestamp,i.time.twelveHourClock)}):W!==B&&e("div",{className:"date",children:de(r.timestamp,i.time.twelveHourClock)})]},w)})})}),e("div",{className:"attachments",children:d.attachments.map((r,w)=>c("div",{className:"attachment",children:[te(r)?e("video",{src:r,controls:!1,muted:!0,loop:!0,autoPlay:!0}):e("img",{src:r}),e(ie,{onClick:()=>{s({...d,attachments:d.attachments.filter((D,R)=>R!==w)})}})]}))}),c("div",{className:"message-bottom",children:[e(Me,{className:"image",onClick:()=>{d.attachments.length<3&&H.Gallery.set({includeVideos:!0,onSelect:r=>s({...d,attachments:[...d.attachments,r.src]})})}}),c("div",{className:"input",children:[e($,{type:"text",placeholder:"Type a message...",ref:y,onChange:r=>{s({...d,content:r.target.value})},onKeyDown:r=>{r.key==="Enter"&&P()}}),e(Te,{className:d.attachments.length>0||d.content.length>0?"active":"",onClick:()=>P()})]})]})]})}const U=o.createContext(null);function ze(){const t=X(Q.Settings),[a,i]=o.useState(!1),[n,h]=o.useState(null),[N,E]=o.useState(null),[I,S]=o.useState("home"),[b,T]=o.useState(!0),m={home:e(Le,{}),profile:e(_e,{}),messageList:e($e,{}),message:e(Fe,{})};return o.useEffect(()=>{if(z.APPS.TINDER.account.value){h(z.APPS.TINDER.account.value),i(!0),T(!1);return}else if(z.APPS.TINDER.account.value===!1)return T(!1);L("Tinder",{action:"isLoggedIn"}).then(l=>{l?(h(l),i(!0),z.APPS.TINDER.account.set(l)):z.APPS.TINDER.account.set(!1),T(!1)})},[]),o.useEffect(()=>{I==="message"?he.ReceiveAppNotifications.set(!1):he.ReceiveAppNotifications.set(!0)},[I]),e("div",{className:"tinder-container",children:e(U.Provider,{value:{LoggedIn:[a,i],Account:[n,h],User:[N,E],View:[I,S]},children:b||t.airplaneMode?e("div",{className:"loading",children:e(Ae,{size:55,speed:.9,color:"#000000"})}):a?m[I]:e(Oe,{})})})}function ee(t){var a=+new Date(t);return~~((Date.now()-a)/315576e5)}export{U as TinderContext,ze as default,ee as getAge};

let animacion=!1;var deg=0,bottom=0,right=0;window.ESX_MENU={},ESX_MENU.ResourceName="esx_menu_default",ESX_MENU.opened={},ESX_MENU.focus=[],ESX_MENU.pos={},ESX_MENU.open=function(e,n,a){void 0===ESX_MENU.opened[e]&&(ESX_MENU.opened[e]={}),void 0!==ESX_MENU.opened[e][n]&&ESX_MENU.close(e,n),void 0===ESX_MENU.pos[e]&&(ESX_MENU.pos[e]={});for(let e=0;e<a.elements.length;e++)void 0===a.elements[e].type&&(a.elements[e].type="default");a._index=ESX_MENU.focus.length,a._namespace=e,a._name=n;for(let s=0;s<a.elements.length;s++)a.elements[s]._namespace=e,a.elements[s]._name=n;ESX_MENU.opened[e][n]=a,ESX_MENU.pos[e][n]=0;for(let s=0;s<a.elements.length;s++)a.elements[s].selected?ESX_MENU.pos[e][n]=s:a.elements[s].selected=!1;ESX_MENU.focus.push({namespace:e,name:n}),animacion=!0,ESX_MENU.render()},ESX_MENU.close=function(e,n){delete ESX_MENU.opened[e][n];for(let a=0;a<ESX_MENU.focus.length;a++)if(ESX_MENU.focus[a].namespace==e&&ESX_MENU.focus[a].name==n){ESX_MENU.focus.splice(a,1);break}ESX_MENU.render()},ESX_MENU.closeAll=function(e,n){$("#menus").html("")},ESX_MENU.render=function(){let e=document.getElementById("menus"),n=ESX_MENU.getFocused();e.innerHTML="",$(e).hide();for(let n in ESX_MENU.opened)for(let a in ESX_MENU.opened[n]){let s=ESX_MENU.opened[n][a],t=JSON.parse(JSON.stringify(s));for(let e=0;e<s.elements.length;e++){let s=t.elements[e];switch(s.type){case"default":break;case"slider":s.isSlider=!0,s.sliderLabel=void 0===s.options?s.value:s.options[s.value]}e==ESX_MENU.pos[n][a]&&(s.selected=!0)}let l=$(Mustache.render('<div id="menu_{{_namespace}}_{{_name}}" class="menu{{#align}} align-{{align}}{{/align}}"><div class="shake"><div class="head"><div class="headtitle">{{{title}}}</div></div><div class="menu-items">{{#elements}}<div class="menu-item {{#selected}}selected{{/selected}}">Â» {{{label}}}{{#isSlider}} : &lt;{{{sliderLabel}}}&gt;{{/isSlider}}</div>{{/elements}}</div></div></div></div>',t))[0];$(l).hide(),e.appendChild(l)}var a=localStorage.getItem("anim");animacion&&"false"!=a?($(".menu").addClass("abrirMenu"),setTimeout(function(){$(".menu").removeClass("abrirMenu")},500)):$(".menu").removeClass("abrirMenu"),void 0!==n&&$("#menu_"+n.namespace+"_"+n.name).show(),$(e).show(),n&&$(".selected").length>=1&&($("#menu_"+n.namespace+"_"+n.name).find(".menu-item.selected")[0].scrollIntoView(),$("#menu_"+n.namespace+"_"+n.name).find(".menu-item.selected")[0].scrollIntoView())},ESX_MENU.submit=function(e,n,a){$.post("http://"+ESX_MENU.ResourceName+"/menu_submit",JSON.stringify({_namespace:e,_name:n,current:a,elements:ESX_MENU.opened[e][n].elements}))},ESX_MENU.cancel=function(e,n){$.post("http://"+ESX_MENU.ResourceName+"/menu_cancel",JSON.stringify({_namespace:e,_name:n}))},ESX_MENU.change=function(e,n,a){$.post("http://"+ESX_MENU.ResourceName+"/menu_change",JSON.stringify({_namespace:e,_name:n,current:a,elements:ESX_MENU.opened[e][n].elements}))},ESX_MENU.getFocused=function(){return ESX_MENU.focus[ESX_MENU.focus.length-1]},window.onData=(e=>{switch(e.action){case"openMenu":animacion=!0,ESX_MENU.open(e.namespace,e.name,e.data);break;case"closeMenu":animacion=!1,bottom=0,right=0,ESX_MENU.close(e.namespace,e.name);break;case"closeAll":ESX_MENU.closeAll();break;case"controlPressed":switch(localStorage.setItem("right",right),localStorage.setItem("bottom",bottom),localStorage.setItem("deg",deg),animacion=!1,e.control){case"ENTER":{let e=ESX_MENU.getFocused();if(void 0!==e){let n=ESX_MENU.opened[e.namespace][e.name],a=ESX_MENU.pos[e.namespace][e.name],s=n.elements[a];n.elements.length>0&&(ESX_MENU.submit(e.namespace,e.name,s),localStorage.setItem("anim","")),setTimeout(function(){$(".menu").removeClass("abrirMenu")},700)}break}case"BACKSPACE":{localStorage.setItem("deg",deg);let e=ESX_MENU.getFocused();animacion=!1,void 0!==e&&($(".menu").addClass("cerrarMenu").fadeOut(400,function(){}),localStorage.setItem("anim",""),setTimeout(function(){$(".menu").removeClass("cerrarMenu"),ESX_MENU.cancel(e.namespace,e.name)},390));break}case"TOP":{let e=ESX_MENU.getFocused();if(void 0!==e){let n=ESX_MENU.opened[e.namespace][e.name];ESX_MENU.pos[e.namespace][e.name]>0?ESX_MENU.pos[e.namespace][e.name]--:ESX_MENU.pos[e.namespace][e.name]=n.elements.length-1;let a=n.elements[ESX_MENU.pos[e.namespace][e.name]];for(let a=0;a<n.elements.length;a++)a==ESX_MENU.pos[e.namespace][e.name]?n.elements[a].selected=!0:n.elements[a].selected=!1;ESX_MENU.change(e.namespace,e.name,a),ESX_MENU.render()}break}case"DOWN":{let e=ESX_MENU.getFocused();if(void 0!==e){let n=ESX_MENU.opened[e.namespace][e.name];ESX_MENU.pos[e.namespace][e.name]<n.elements.length-1?ESX_MENU.pos[e.namespace][e.name]++:ESX_MENU.pos[e.namespace][e.name]=0;let a=n.elements[ESX_MENU.pos[e.namespace][e.name]];for(let a=0;a<n.elements.length;a++)a==ESX_MENU.pos[e.namespace][e.name]?n.elements[a].selected=!0:n.elements[a].selected=!1;ESX_MENU.change(e.namespace,e.name,a),ESX_MENU.render()}break}case"LEFT":{let e=ESX_MENU.getFocused();if(void 0!==e){let n=ESX_MENU.opened[e.namespace][e.name],a=ESX_MENU.pos[e.namespace][e.name],s=n.elements[a];switch(s.type){case"default":break;case"slider":{let n=void 0===s.min?0:s.min;s.value>n&&(s.value--,localStorage.setItem("anim","false"),ESX_MENU.change(e.namespace,e.name,s)),ESX_MENU.render();break}}}break}case"RIGHT":{let e=ESX_MENU.getFocused();if(void 0!==e){let n=ESX_MENU.opened[e.namespace][e.name],a=ESX_MENU.pos[e.namespace][e.name],s=n.elements[a];switch(s.type){case"default":break;case"slider":void 0!==s.options&&s.value<s.options.length-1&&(s.value++,ESX_MENU.change(e.namespace,e.name,s)),void 0!==s.max&&s.value<s.max&&(s.value++,ESX_MENU.change(e.namespace,e.name,s)),localStorage.setItem("anim","false"),ESX_MENU.render()}}break}}}}),window.onload=function(e){window.addEventListener("message",e=>{onData(e.data)})};